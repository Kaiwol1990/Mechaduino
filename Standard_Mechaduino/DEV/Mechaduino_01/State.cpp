//Contains the declaration of the state variables for the control loop
#include <Wire.h>
#include "State.h"
#include "Parameters.h"


//---- interrupt vars ----
volatile int r = 0;                 //target angle
volatile long y = 0;                //current angle
volatile long y_1 = 0;                //last angle

volatile int raw_0 = 0;             // current measured angle
volatile int raw_1 = 0;             // last measured angle
volatile int raw_diff = 0;          // diff of both
volatile int u = 0;                 // control effort

volatile long ITerm = 0;            // Integral term

volatile int e_0 = 0;               // current error term
volatile int e_1 = 0;               // last error term

volatile bool dir = true;           // flag for dir setting
volatile bool enabled = true;       // flag for enabled setting

bool calibration_running = false;   // flag for calibration
bool frequency_test = false;        // flag for frequency test


//----current settings-----
const float rSense = 0.150;                           // resistor value
const int uMAX = ((1024 * iMAX * 10 * rSense) / 3.3);  // max voltage for the vref pins


//---- Step settings -----
const int counts_per_revolution = 16384;                              // encoder counts for 360 degrees
const float angle_per_step = 360.0 / steps_per_revolution;            // only needed for calibration routine by now
const int stepangle = 36000 / (steps_per_revolution*microstepping);   // angle of one step as int
volatile const int PA = (36000 / steps_per_revolution);               // angle of one fullstep
volatile int step_target = 0;                                         // target as step gets incremented if an step is received


//--- lookup tables for the coils ---
// take a look at the current plot for microstepping online

const PROGMEM int_fast16_t sine_lookup_coil_A[] = {724, 725, 727, 728, 729, 730, 732, 733, 734, 735, 737, 738, 739, 740, 742, 743, 744, 745, 746, 748, 749, 750, 751, 753, 754, 755, 756, 757, 759, 760, 761, 762, 763, 765, 766, 767, 768, 769, 770, 772, 773, 774, 775, 776, 778, 779, 780, 781, 782, 783, 784, 786, 787, 788, 789, 790, 791, 792, 794, 795, 796, 797, 798, 799, 800, 801, 803, 804, 805, 806, 807, 808, 809, 810, 811, 812, 814, 815, 816, 817, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 830, 831, 832, 833, 834, 835, 836, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 863, 864, 865, 866, 867, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 879, 880, 881, 881, 882, 883, 884, 885, 886, 887, 888, 889, 890, 890, 891, 892, 893, 894, 895, 896, 897, 897, 898, 899, 900, 901, 902, 902, 903, 904, 905, 906, 907, 908, 908, 909, 910, 911, 912, 912, 913, 914, 915, 916, 916, 917, 918, 919, 920, 920, 921, 922, 923, 924, 924, 925, 926, 927, 927, 928, 929, 930, 930, 931, 932, 933, 933, 934, 935, 936, 936, 937, 938, 938, 939, 940, 941, 941, 942, 943, 943, 944, 945, 945, 946, 947, 947, 948, 949, 949, 950, 951, 951, 952, 953, 953, 954, 955, 955, 956, 957, 957, 958, 959, 959, 960, 960, 961, 962, 962, 963, 964, 964, 965, 965, 966, 966, 967, 968, 968, 969, 969, 970, 971, 971, 972, 972, 973, 973, 974, 974, 975, 976, 976, 977, 977, 978, 978, 979, 979, 980, 980, 981, 981, 982, 982, 983, 983, 984, 984, 985, 985, 986, 986, 987, 987, 988, 988, 989, 989, 990, 990, 991, 991, 991, 992, 992, 993, 993, 994, 994, 994, 995, 995, 996, 996, 997, 997, 997, 998, 998, 999, 999, 999, 1000, 1000, 1001, 1001, 1001, 1002, 1002, 1002, 1003, 1003, 1003, 1004, 1004, 1005, 1005, 1005, 1006, 1006, 1006, 1007, 1007, 1007, 1008, 1008, 1008, 1008, 1009, 1009, 1009, 1010, 1010, 1010, 1011, 1011, 1011, 1011, 1012, 1012, 1012, 1013, 1013, 1013, 1013, 1014, 1014, 1014, 1014, 1015, 1015, 1015, 1015, 1015, 1016, 1016, 1016, 1016, 1017, 1017, 1017, 1017, 1017, 1018, 1018, 1018, 1018, 1018, 1019, 1019, 1019, 1019, 1019, 1019, 1020, 1020, 1020, 1020, 1020, 1020, 1021, 1021, 1021, 1021, 1021, 1021, 1021, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1021, 1021, 1021, 1021, 1021, 1021, 1021, 1021, 1020, 1020, 1020, 1020, 1020, 1020, 1019, 1019, 1019, 1019, 1019, 1019, 1018, 1018, 1018, 1018, 1018, 1017, 1017, 1017, 1017, 1017, 1016, 1016, 1016, 1016, 1015, 1015, 1015, 1015, 1014, 1014, 1014, 1014, 1013, 1013, 1013, 1013, 1012, 1012, 1012, 1012, 1011, 1011, 1011, 1010, 1010, 1010, 1010, 1009, 1009, 1009, 1008, 1008, 1008, 1007, 1007, 1007, 1006, 1006, 1006, 1005, 1005, 1005, 1004, 1004, 1004, 1003, 1003, 1003, 1002, 1002, 1002, 1001, 1001, 1000, 1000, 1000, 999, 999, 998, 998, 998, 997, 997, 996, 996, 996, 995, 995, 994, 994, 994, 993, 993, 992, 992, 991, 991, 990, 990, 989, 989, 989, 988, 988, 987, 987, 986, 986, 985, 985, 984, 984, 983, 983, 982, 982, 981, 981, 980, 980, 979, 979, 978, 978, 977, 977, 976, 975, 975, 974, 974, 973, 973, 972, 972, 971, 970, 970, 969, 969, 968, 968, 967, 966, 966, 965, 965, 964, 963, 963, 962, 962, 961, 960, 960, 959, 958, 958, 957, 957, 956, 955, 955, 954, 953, 953, 952, 951, 951, 950, 949, 949, 948, 947, 947, 946, 945, 945, 944, 943, 942, 942, 941, 940, 940, 939, 938, 938, 937, 936, 935, 935, 934, 933, 932, 932, 931, 930, 929, 929, 928, 927, 926, 926, 925, 924, 923, 923, 922, 921, 920, 919, 919, 918, 917, 916, 915, 915, 914, 913, 912, 911, 911, 910, 909, 908, 907, 906, 906, 905, 904, 903, 902, 901, 901, 900, 899, 898, 897, 896, 895, 895, 894, 893, 892, 891, 890, 889, 888, 888, 887, 886, 885, 884, 883, 882, 881, 880, 879, 878, 878, 877, 876, 875, 874, 873, 872, 871, 870, 869, 868, 867, 866, 865, 864, 863, 862, 861, 861, 860, 859, 858, 857, 856, 855, 854, 853, 852, 851, 850, 849, 848, 847, 846, 845, 844, 843, 842, 841, 840, 839, 838, 837, 835, 834, 833, 832, 831, 830, 829, 828, 827, 826, 825, 824, 823, 822, 821, 820, 819, 818, 816, 815, 814, 813, 812, 811, 810, 809, 808, 807, 806, 804, 803, 802, 801, 800, 799, 798, 797, 796, 794, 793, 792, 791, 790, 789, 788, 786, 785, 784, 783, 782, 781, 780, 778, 777, 776, 775, 774, 773, 771, 770, 769, 768, 767, 765, 764, 763, 762, 761, 759, 758, 757, 756, 755, 753, 752, 751, 750, 749, 747, 746, 745, 744, 742, 741, 740, 739, 738, 736, 735, 734, 733, 731, 730, 729, 728, 726, 725, 724, 722, 721, 720, 719, 717, 716, 715, 714, 712, 711, 710, 708, 707, 706, 705, 703, 702, 701, 699, 698, 697, 695, 694, 693, 691, 690, 689, 687, 686, 685, 684, 682, 681, 680, 678, 677, 675, 674, 673, 671, 670, 669, 667, 666, 665, 663, 662, 661, 659, 658, 656, 655, 654, 652, 651, 650, 648, 647, 645, 644, 643, 641, 640, 638, 637, 636, 634, 633, 631, 630, 629, 627, 626, 624, 623, 622, 620, 619, 617, 616, 614, 613, 612, 610, 609, 607, 606, 604, 603, 601, 600, 599, 597, 596, 594, 593, 591, 590, 588, 587, 585, 584, 583, 581, 580, 578, 577, 575, 574, 572, 571, 569, 568, 566, 565, 563, 562, 560, 559, 557, 556, 554, 553, 551, 550, 548, 547, 545, 544, 542, 541, 539, 538, 536, 535, 533, 532, 530, 528, 527, 525, 524, 522, 521, 519, 518, 516, 515, 513, 512, 510, 508, 507, 505, 504, 502, 501, 499, 498, 496, 494, 493, 491, 490, 488, 487, 485, 483, 482, 480, 479, 477, 476, 474, 472, 471, 469, 468, 466, 464, 463, 461, 460, 458, 456, 455, 453, 452, 450, 448, 447, 445, 444, 442, 440, 439, 437, 436, 434, 432, 431, 429, 427, 426, 424, 423, 421, 419, 418, 416, 414, 413, 411, 409, 408, 406, 405, 403, 401, 400, 398, 396, 395, 393, 391, 390, 388, 386, 385, 383, 381, 380, 378, 376, 375, 373, 371, 370, 368, 366, 365, 363, 361, 360, 358, 356, 355, 353, 351, 350, 348, 346, 345, 343, 341, 340, 338, 336, 335, 333, 331, 329, 328, 326, 324, 323, 321, 319, 318, 316, 314, 312, 311, 309, 307, 306, 304, 302, 301, 299, 297, 295, 294, 292, 290, 289, 287, 285, 283, 282, 280, 278, 277, 275, 273, 271, 270, 268, 266, 264, 263, 261, 259, 258, 256, 254, 252, 251, 249, 247, 245, 244, 242, 240, 238, 237, 235, 233, 231, 230, 228, 226, 225, 223, 221, 219, 218, 216, 214, 212, 211, 209, 207, 205, 204, 202, 200, 198, 197, 195, 193, 191, 190, 188, 186, 184, 182, 181, 179, 177, 175, 174, 172, 170, 168, 167, 165, 163, 161, 160, 158, 156, 154, 153, 151, 149, 147, 145, 144, 142, 140, 138, 137, 135, 133, 131, 129, 128, 126, 124, 122, 121, 119, 117, 115, 114, 112, 110, 108, 106, 105, 103, 101, 99, 98, 96, 94, 92, 90, 89, 87, 85, 83, 81, 80, 78, 76, 74, 73, 71, 69, 67, 65, 64, 62, 60, 58, 57, 55, 53, 51, 49, 48, 46, 44, 42, 40, 39, 37, 35, 33, 32, 30, 28, 26, 24, 23, 21, 19, 17, 15, 14, 12, 10, 8, 6, 5, 3, 1, -1, -2, -4, -6, -8, -10, -11, -13, -15, -17, -19, -20, -22, -24, -26, -27, -29, -31, -33, -35, -36, -38, -40, -42, -44, -45, -47, -49, -51, -52, -54, -56, -58, -60, -61, -63, -65, -67, -69, -70, -72, -74, -76, -77, -79, -81, -83, -85, -86, -88, -90, -92, -94, -95, -97, -99, -101, -102, -104, -106, -108, -110, -111, -113, -115, -117, -118, -120, -122, -124, -125, -127, -129, -131, -133, -134, -136, -138, -140, -141, -143, -145, -147, -149, -150, -152, -154, -156, -157, -159, -161, -163, -164, -166, -168, -170, -171, -173, -175, -177, -179, -180, -182, -184, -186, -187, -189, -191, -193, -194, -196, -198, -200, -201, -203, -205, -207, -208, -210, -212, -214, -215, -217, -219, -221, -222, -224, -226, -228, -229, -231, -233, -235, -236, -238, -240, -242, -243, -245, -247, -248, -250, -252, -254, -255, -257, -259, -261, -262, -264, -266, -267, -269, -271, -273, -274, -276, -278, -280, -281, -283, -285, -286, -288, -290, -292, -293, -295, -297, -298, -300, -302, -304, -305, -307, -309, -310, -312, -314, -315, -317, -319, -321, -322, -324, -326, -327, -329, -331, -332, -334, -336, -337, -339, -341, -343, -344, -346, -348, -349, -351, -353, -354, -356, -358, -359, -361, -363, -364, -366, -368, -369, -371, -373, -374, -376, -378, -379, -381, -383, -384, -386, -388, -389, -391, -393, -394, -396, -398, -399, -401, -402, -404, -406, -407, -409, -411, -412, -414, -416, -417, -419, -420, -422, -424, -425, -427, -429, -430, -432, -433, -435, -437, -438, -440, -442, -443, -445, -446, -448, -450, -451, -453, -454, -456, -458, -459, -461, -462, -464, -466, -467, -469, -470, -472, -474, -475, -477, -478, -480, -481, -483, -485, -486, -488, -489, -491, -492, -494, -496, -497, -499, -500, -502, -503, -505, -507, -508, -510, -511, -513, -514, -516, -517, -519, -520, -522, -524, -525, -527, -528, -530, -531, -533, -534, -536, -537, -539, -540, -542, -543, -545, -546, -548, -549, -551, -552, -554, -555, -557, -558, -560, -561, -563, -564, -566, -567, -569, -570, -572, -573, -575, -576, -578, -579, -581, -582, -584, -585, -587, -588, -589, -591, -592, -594, -595, -597, -598, -600, -601, -603, -604, -605, -607, -608, -610, -611, -613, -614, -616, -617, -618, -620, -621, -623, -624, -625, -627, -628, -630, -631, -633, -634, -635, -637, -638, -640, -641, -642, -644, -645, -646, -648, -649, -651, -652, -653, -655, -656, -658, -659, -660, -662, -663, -664, -666, -667, -668, -670, -671, -672, -674, -675, -677, -678, -679, -681, -682, -683, -685, -686, -687, -688, -690, -691, -692, -694, -695, -696, -698, -699, -700, -702, -703, -704, -706, -707, -708, -709, -711, -712, -713, -715, -716, -717, -718, -720, -721, -722, -723, -725, -726, -727, -728, -730, -731, -732, -733, -735, -736, -737, -738, -740, -741, -742, -743, -745, -746, -747, -748, -750, -751, -752, -753, -754, -756, -757, -758, -759, -760, -762, -763, -764, -765, -766, -768, -769, -770, -771, -772, -773, -775, -776, -777, -778, -779, -780, -782, -783, -784, -785, -786, -787, -788, -790, -791, -792, -793, -794, -795, -796, -798, -799, -800, -801, -802, -803, -804, -805, -806, -807, -809, -810, -811, -812, -813, -814, -815, -816, -817, -818, -819, -821, -822, -823, -824, -825, -826, -827, -828, -829, -830, -831, -832, -833, -834, -835, -836, -837, -838, -839, -840, -841, -842, -843, -844, -845, -846, -847, -848, -849, -850, -851, -852, -853, -854, -855, -856, -857, -858, -859, -860, -861, -862, -863, -864, -865, -866, -867, -868, -869, -870, -871, -872, -873, -874, -875, -875, -876, -877, -878, -879, -880, -881, -882, -883, -884, -885, -886, -886, -887, -888, -889, -890, -891, -892, -893, -893, -894, -895, -896, -897, -898, -899, -900, -900, -901, -902, -903, -904, -905, -905, -906, -907, -908, -909, -910, -910, -911, -912, -913, -914, -914, -915, -916, -917, -918, -918, -919, -920, -921, -922, -922, -923, -924, -925, -925, -926, -927, -928, -928, -929, -930, -931, -931, -932, -933, -934, -934, -935, -936, -937, -937, -938, -939, -939, -940, -941, -942, -942, -943, -944, -944, -945, -946, -946, -947, -948, -948, -949, -950, -950, -951, -952, -952, -953, -954, -954, -955, -956, -956, -957, -958, -958, -959, -960, -960, -961, -961, -962, -963, -963, -964, -964, -965, -966, -966, -967, -967, -968, -969, -969, -970, -970, -971, -971, -972, -973, -973, -974, -974, -975, -975, -976, -976, -977, -977, -978, -979, -979, -980, -980, -981, -981, -982, -982, -983, -983, -984, -984, -985, -985, -986, -986, -987, -987, -988, -988, -988, -989, -989, -990, -990, -991, -991, -992, -992, -993, -993, -993, -994, -994, -995, -995, -996, -996, -996, -997, -997, -998, -998, -998, -999, -999, -1000, -1000, -1000, -1001, -1001, -1001, -1002, -1002, -1003, -1003, -1003, -1004, -1004, -1004, -1005, -1005, -1005, -1006, -1006, -1006, -1007, -1007, -1007, -1008, -1008, -1008, -1009, -1009, -1009, -1010, -1010, -1010, -1010, -1011, -1011, -1011, -1012, -1012, -1012, -1012, -1013, -1013, -1013, -1013, -1014, -1014, -1014, -1014, -1015, -1015, -1015, -1015, -1016, -1016, -1016, -1016, -1016, -1017, -1017, -1017, -1017, -1018, -1018, -1018, -1018, -1018, -1019, -1019, -1019, -1019, -1019, -1019, -1020, -1020, -1020, -1020, -1020, -1020, -1020, -1021, -1021, -1021, -1021, -1021, -1021, -1021, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1021, -1021, -1021, -1021, -1021, -1021, -1021, -1020, -1020, -1020, -1020, -1020, -1020, -1020, -1019, -1019, -1019, -1019, -1019, -1018, -1018, -1018, -1018, -1018, -1017, -1017, -1017, -1017, -1017, -1016, -1016, -1016, -1016, -1016, -1015, -1015, -1015, -1015, -1014, -1014, -1014, -1014, -1013, -1013, -1013, -1013, -1012, -1012, -1012, -1011, -1011, -1011, -1011, -1010, -1010, -1010, -1009, -1009, -1009, -1009, -1008, -1008, -1008, -1007, -1007, -1007, -1006, -1006, -1006, -1005, -1005, -1005, -1004, -1004, -1004, -1003, -1003, -1002, -1002, -1002, -1001, -1001, -1001, -1000, -1000, -999, -999, -999, -998, -998, -997, -997, -997, -996, -996, -995, -995, -995, -994, -994, -993, -993, -992, -992, -992, -991, -991, -990, -990, -989, -989, -988, -988, -987, -987, -986, -986, -985, -985, -984, -984, -984, -983, -983, -982, -981, -981, -980, -980, -979, -979, -978, -978, -977, -977, -976, -976, -975, -975, -974, -974, -973, -972, -972, -971, -971, -970, -970, -969, -968, -968, -967, -967, -966, -965, -965, -964, -964, -963, -962, -962, -961, -961, -960, -959, -959, -958, -957, -957, -956, -956, -955, -954, -954, -953, -952, -952, -951, -950, -950, -949, -948, -948, -947, -946, -946, -945, -944, -944, -943, -942, -941, -941, -940, -939, -939, -938, -937, -936, -936, -935, -934, -934, -933, -932, -931, -931, -930, -929, -928, -928, -927, -926, -925, -924, -924, -923, -922, -921, -921, -920, -919, -918, -917, -917, -916, -915, -914, -913, -913, -912, -911, -910, -909, -909, -908, -907, -906, -905, -904, -904, -903, -902, -901, -900, -899, -898, -898, -897, -896, -895, -894, -893, -892, -892, -891, -890, -889, -888, -887, -886, -885, -884, -883, -883, -882, -881, -880, -879, -878, -877, -876, -875, -874, -873, -872, -871, -871, -870, -869, -868, -867, -866, -865, -864, -863, -862, -861, -860, -859, -858, -857, -856, -855, -854, -853, -852, -851, -850, -849, -848, -847, -846, -845, -844, -843, -842, -841, -840, -839, -838, -837, -836, -835, -834, -833, -832, -831, -830, -829, -828, -827, -826, -825, -823, -822, -821, -820, -819, -818, -817, -816, -815, -814, -813, -812, -811, -809, -808, -807, -806, -805, -804, -803, -802, -801, -799, -798, -797, -796, -795, -794, -793, -792, -790, -789, -788, -787, -786, -785, -784, -782, -781, -780, -779, -778, -777, -775, -774, -773, -772, -771, -770, -768, -767, -766, -765, -764, -762, -761, -760, -759, -758, -756, -755, -754, -753, -752, -750, -749, -748, -747, -746, -744, -743, -742, -741, -739, -738, -737, -736, -734, -733, -732, -731, -729, -728, -727, -726, -724, -723, -722, -721, -719, -718, -717, -715, -714, -713, -712, -710, -709, -708, -706, -705, -704, -703, -701, -700, -699, -697, -696, -695, -693, -692, -691, -689, -688, -687, -686, -684, -683, -682, -680, -679, -678, -676, -675, -673, -672, -671, -669, -668, -667, -665, -664, -663, -661, -660, -659, -657, -656, -654, -653, -652, -650, -649, -648, -646, -645, -643, -642, -641, -639, -638, -636, -635, -634, -632, -631, -629, -628, -627, -625, -624, -622, -621, -619, -618, -617, -615, -614, -612, -611, -609, -608, -607, -605, -604, -602, -601, -599, -598, -596, -595, -594, -592, -591, -589, -588, -586, -585, -583, -582, -580, -579, -577, -576, -574, -573, -571, -570, -568, -567, -566, -564, -563, -561, -560, -558, -557, -555, -554, -552, -551, -549, -547, -546, -544, -543, -541, -540, -538, -537, -535, -534, -532, -531, -529, -528, -526, -525, -523, -522, -520, -518, -517, -515, -514, -512, -511, -509, -508, -506, -505, -503, -501, -500, -498, -497, -495, -494, -492, -490, -489, -487, -486, -484, -483, -481, -479, -478, -476, -475, -473, -472, -470, -468, -467, -465, -464, -462, -460, -459, -457, -456, -454, -452, -451, -449, -448, -446, -444, -443, -441, -440, -438, -436, -435, -433, -431, -430, -428, -427, -425, -423, -422, -420, -418, -417, -415, -414, -412, -410, -409, -407, -405, -404, -402, -400, -399, -397, -395, -394, -392, -391, -389, -387, -386, -384, -382, -381, -379, -377, -376, -374, -372, -371, -369, -367, -366, -364, -362, -361, -359, -357, -356, -354, -352, -351, -349, -347, -345, -344, -342, -340, -339, -337, -335, -334, -332, -330, -329, -327, -325, -324, -322, -320, -318, -317, -315, -313, -312, -310, -308, -307, -305, -303, -301, -300, -298, -296, -295, -293, -291, -289, -288, -286, -284, -283, -281, -279, -277, -276, -274, -272, -270, -269, -267, -265, -264, -262, -260, -258, -257, -255, -253, -251, -250, -248, -246, -245, -243, -241, -239, -238, -236, -234, -232, -231, -229, -227, -225, -224, -222, -220, -218, -217, -215, -213, -211, -210, -208, -206, -204, -203, -201, -199, -197, -196, -194, -192, -190, -189, -187, -185, -183, -182, -180, -178, -176, -175, -173, -171, -169, -168, -166, -164, -162, -160, -159, -157, -155, -153, -152, -150, -148, -146, -145, -143, -141, -139, -137, -136, -134, -132, -130, -129, -127, -125, -123, -121, -120, -118, -116, -114, -113, -111, -109, -107, -106, -104, -102, -100, -98, -97, -95, -93, -91, -89, -88, -86, -84, -82, -81, -79, -77, -75, -73, -72, -70, -68, -66, -65, -63, -61, -59, -57, -56, -54, -52, -50, -48, -47, -45, -43, -41, -40, -38, -36, -34, -32, -31, -29, -27, -25, -23, -22, -20, -18, -16, -15, -13, -11, -9, -7, -6, -4, -2, 0, 2, 3, 5, 7, 9, 11, 12, 14, 16, 18, 19, 21, 23, 25, 27, 28, 30, 32, 34, 36, 37, 39, 41, 43, 44, 46, 48, 50, 52, 53, 55, 57, 59, 61, 62, 64, 66, 68, 69, 71, 73, 75, 77, 78, 80, 82, 84, 85, 87, 89, 91, 93, 94, 96, 98, 100, 102, 103, 105, 107, 109, 110, 112, 114, 116, 118, 119, 121, 123, 125, 126, 128, 130, 132, 133, 135, 137, 139, 141, 142, 144, 146, 148, 149, 151, 153, 155, 156, 158, 160, 162, 164, 165, 167, 169, 171, 172, 174, 176, 178, 179, 181, 183, 185, 186, 188, 190, 192, 193, 195, 197, 199, 200, 202, 204, 206, 207, 209, 211, 213, 214, 216, 218, 220, 221, 223, 225, 227, 228, 230, 232, 234, 235, 237, 239, 241, 242, 244, 246, 248, 249, 251, 253, 255, 256, 258, 260, 261, 263, 265, 267, 268, 270, 272, 274, 275, 277, 279, 280, 282, 284, 286, 287, 289, 291, 292, 294, 296, 298, 299, 301, 303, 304, 306, 308, 309, 311, 313, 315, 316, 318, 320, 321, 323, 325, 326, 328, 330, 332, 333, 335, 337, 338, 340, 342, 343, 345, 347, 348, 350, 352, 353, 355, 357, 359, 360, 362, 364, 365, 367, 369, 370, 372, 374, 375, 377, 379, 380, 382, 383, 385, 387, 388, 390, 392, 393, 395, 397, 398, 400, 402, 403, 405, 407, 408, 410, 411, 413, 415, 416, 418, 420, 421, 423, 425, 426, 428, 429, 431, 433, 434, 436, 438, 439, 441, 442, 444, 446, 447, 449, 450, 452, 454, 455, 457, 458, 460, 462, 463, 465, 466, 468, 470, 471, 473, 474, 476, 478, 479, 481, 482, 484, 485, 487, 489, 490, 492, 493, 495, 496, 498, 500, 501, 503, 504, 506, 507, 509, 510, 512, 513, 515, 517, 518, 520, 521, 523, 524, 526, 527, 529, 530, 532, 533, 535, 537, 538, 540, 541, 543, 544, 546, 547, 549, 550, 552, 553, 555, 556, 558, 559, 561, 562, 564, 565, 567, 568, 570, 571, 573, 574, 576, 577, 578, 580, 581, 583, 584, 586, 587, 589, 590, 592, 593, 595, 596, 598, 599, 600, 602, 603, 605, 606, 608, 609, 611, 612, 613, 615, 616, 618, 619, 621, 622, 623, 625, 626, 628, 629, 630, 632, 633, 635, 636, 637, 639, 640, 642, 643, 644, 646, 647, 649, 650, 651, 653, 654, 655, 657, 658, 660, 661, 662, 664, 665, 666, 668, 669, 670, 672, 673, 674, 676, 677, 679, 680, 681, 683, 684, 685, 687, 688, 689, 690, 692, 693, 694, 696, 697, 698, 700, 701, 702, 704, 705, 706, 707, 709, 710, 711, 713, 714, 715, 716, 718, 719, 720, 722, 723, 724,
                                                  };
const PROGMEM int_fast16_t sine_lookup_coil_B[] = {724, 723, 722, 720, 719, 718, 716, 715, 714, 713, 711, 710, 709, 707, 706, 705, 704, 702, 701, 700, 698, 697, 696, 694, 693, 692, 690, 689, 688, 687, 685, 684, 683, 681, 680, 679, 677, 676, 674, 673, 672, 670, 669, 668, 666, 665, 664, 662, 661, 660, 658, 657, 655, 654, 653, 651, 650, 649, 647, 646, 644, 643, 642, 640, 639, 637, 636, 635, 633, 632, 630, 629, 628, 626, 625, 623, 622, 620, 619, 618, 616, 615, 613, 612, 610, 609, 608, 606, 605, 603, 602, 600, 599, 598, 596, 595, 593, 592, 590, 589, 587, 586, 584, 583, 581, 580, 578, 577, 576, 574, 573, 571, 570, 568, 567, 565, 564, 562, 561, 559, 558, 556, 555, 553, 552, 550, 549, 547, 546, 544, 543, 541, 540, 538, 537, 535, 533, 532, 530, 529, 527, 526, 524, 523, 521, 520, 518, 517, 515, 513, 512, 510, 509, 507, 506, 504, 503, 501, 499, 498, 496, 495, 493, 492, 490, 489, 487, 485, 484, 482, 481, 479, 477, 476, 474, 473, 471, 470, 468, 466, 465, 463, 462, 460, 458, 457, 455, 454, 452, 450, 449, 447, 446, 444, 442, 441, 439, 438, 436, 434, 433, 431, 429, 428, 426, 425, 423, 421, 420, 418, 416, 415, 413, 411, 410, 408, 407, 405, 403, 402, 400, 398, 397, 395, 393, 392, 390, 388, 387, 385, 383, 382, 380, 379, 377, 375, 374, 372, 370, 369, 367, 365, 364, 362, 360, 358, 357, 355, 353, 352, 350, 348, 347, 345, 343, 342, 340, 338, 337, 335, 333, 332, 330, 328, 326, 325, 323, 321, 320, 318, 316, 315, 313, 311, 309, 308, 306, 304, 303, 301, 299, 298, 296, 294, 292, 291, 289, 287, 286, 284, 282, 280, 279, 277, 275, 274, 272, 270, 268, 267, 265, 263, 261, 260, 258, 256, 255, 253, 251, 249, 248, 246, 244, 242, 241, 239, 237, 235, 234, 232, 230, 228, 227, 225, 223, 221, 220, 218, 216, 214, 213, 211, 209, 207, 206, 204, 202, 200, 199, 197, 195, 193, 192, 190, 188, 186, 185, 183, 181, 179, 178, 176, 174, 172, 171, 169, 167, 165, 164, 162, 160, 158, 156, 155, 153, 151, 149, 148, 146, 144, 142, 141, 139, 137, 135, 133, 132, 130, 128, 126, 125, 123, 121, 119, 118, 116, 114, 112, 110, 109, 107, 105, 103, 102, 100, 98, 96, 94, 93, 91, 89, 87, 85, 84, 82, 80, 78, 77, 75, 73, 71, 69, 68, 66, 64, 62, 61, 59, 57, 55, 53, 52, 50, 48, 46, 44, 43, 41, 39, 37, 36, 34, 32, 30, 28, 27, 25, 23, 21, 19, 18, 16, 14, 12, 10, 9, 7, 5, 3, 2, 0, -2, -4, -6, -7, -9, -11, -13, -15, -16, -18, -20, -22, -23, -25, -27, -29, -31, -32, -34, -36, -38, -40, -41, -43, -45, -47, -48, -50, -52, -54, -56, -57, -59, -61, -63, -65, -66, -68, -70, -72, -73, -75, -77, -79, -81, -82, -84, -86, -88, -90, -91, -93, -95, -97, -98, -100, -102, -104, -106, -107, -109, -111, -113, -114, -116, -118, -120, -122, -123, -125, -127, -129, -130, -132, -134, -136, -137, -139, -141, -143, -145, -146, -148, -150, -152, -153, -155, -157, -159, -160, -162, -164, -166, -168, -169, -171, -173, -175, -176, -178, -180, -182, -183, -185, -187, -189, -190, -192, -194, -196, -197, -199, -201, -203, -204, -206, -208, -210, -211, -213, -215, -217, -218, -220, -222, -224, -225, -227, -229, -231, -232, -234, -236, -238, -239, -241, -243, -245, -246, -248, -250, -251, -253, -255, -257, -258, -260, -262, -264, -265, -267, -269, -271, -272, -274, -276, -277, -279, -281, -283, -284, -286, -288, -289, -291, -293, -295, -296, -298, -300, -301, -303, -305, -307, -308, -310, -312, -313, -315, -317, -318, -320, -322, -324, -325, -327, -329, -330, -332, -334, -335, -337, -339, -340, -342, -344, -345, -347, -349, -351, -352, -354, -356, -357, -359, -361, -362, -364, -366, -367, -369, -371, -372, -374, -376, -377, -379, -381, -382, -384, -386, -387, -389, -391, -392, -394, -395, -397, -399, -400, -402, -404, -405, -407, -409, -410, -412, -414, -415, -417, -418, -420, -422, -423, -425, -427, -428, -430, -431, -433, -435, -436, -438, -440, -441, -443, -444, -446, -448, -449, -451, -452, -454, -456, -457, -459, -460, -462, -464, -465, -467, -468, -470, -472, -473, -475, -476, -478, -479, -481, -483, -484, -486, -487, -489, -491, -492, -494, -495, -497, -498, -500, -501, -503, -505, -506, -508, -509, -511, -512, -514, -515, -517, -519, -520, -522, -523, -525, -526, -528, -529, -531, -532, -534, -535, -537, -538, -540, -541, -543, -544, -546, -548, -549, -551, -552, -554, -555, -557, -558, -560, -561, -563, -564, -566, -567, -568, -570, -571, -573, -574, -576, -577, -579, -580, -582, -583, -585, -586, -588, -589, -591, -592, -594, -595, -596, -598, -599, -601, -602, -604, -605, -607, -608, -609, -611, -612, -614, -615, -617, -618, -619, -621, -622, -624, -625, -627, -628, -629, -631, -632, -634, -635, -636, -638, -639, -641, -642, -643, -645, -646, -648, -649, -650, -652, -653, -654, -656, -657, -659, -660, -661, -663, -664, -665, -667, -668, -669, -671, -672, -673, -675, -676, -678, -679, -680, -682, -683, -684, -686, -687, -688, -689, -691, -692, -693, -695, -696, -697, -699, -700, -701, -703, -704, -705, -706, -708, -709, -710, -712, -713, -714, -715, -717, -718, -719, -721, -722, -723, -724, -726, -727, -728, -729, -731, -732, -733, -734, -736, -737, -738, -739, -741, -742, -743, -744, -746, -747, -748, -749, -750, -752, -753, -754, -755, -756, -758, -759, -760, -761, -762, -764, -765, -766, -767, -768, -770, -771, -772, -773, -774, -775, -777, -778, -779, -780, -781, -782, -784, -785, -786, -787, -788, -789, -790, -792, -793, -794, -795, -796, -797, -798, -799, -801, -802, -803, -804, -805, -806, -807, -808, -809, -811, -812, -813, -814, -815, -816, -817, -818, -819, -820, -821, -822, -823, -825, -826, -827, -828, -829, -830, -831, -832, -833, -834, -835, -836, -837, -838, -839, -840, -841, -842, -843, -844, -845, -846, -847, -848, -849, -850, -851, -852, -853, -854, -855, -856, -857, -858, -859, -860, -861, -862, -863, -864, -865, -866, -867, -868, -869, -870, -871, -872, -872, -873, -874, -875, -876, -877, -878, -879, -880, -881, -882, -883, -883, -884, -885, -886, -887, -888, -889, -890, -891, -892, -892, -893, -894, -895, -896, -897, -898, -898, -899, -900, -901, -902, -903, -904, -904, -905, -906, -907, -908, -909, -909, -910, -911, -912, -913, -913, -914, -915, -916, -917, -917, -918, -919, -920, -921, -921, -922, -923, -924, -924, -925, -926, -927, -928, -928, -929, -930, -931, -931, -932, -933, -934, -934, -935, -936, -936, -937, -938, -939, -939, -940, -941, -941, -942, -943, -944, -944, -945, -946, -946, -947, -948, -948, -949, -950, -950, -951, -952, -952, -953, -954, -954, -955, -956, -956, -957, -957, -958, -959, -959, -960, -961, -961, -962, -962, -963, -964, -964, -965, -965, -966, -967, -967, -968, -968, -969, -970, -970, -971, -971, -972, -972, -973, -974, -974, -975, -975, -976, -976, -977, -977, -978, -978, -979, -979, -980, -980, -981, -981, -982, -983, -983, -984, -984, -984, -985, -985, -986, -986, -987, -987, -988, -988, -989, -989, -990, -990, -991, -991, -992, -992, -992, -993, -993, -994, -994, -995, -995, -995, -996, -996, -997, -997, -997, -998, -998, -999, -999, -999, -1000, -1000, -1001, -1001, -1001, -1002, -1002, -1002, -1003, -1003, -1004, -1004, -1004, -1005, -1005, -1005, -1006, -1006, -1006, -1007, -1007, -1007, -1008, -1008, -1008, -1009, -1009, -1009, -1009, -1010, -1010, -1010, -1011, -1011, -1011, -1011, -1012, -1012, -1012, -1013, -1013, -1013, -1013, -1014, -1014, -1014, -1014, -1015, -1015, -1015, -1015, -1016, -1016, -1016, -1016, -1016, -1017, -1017, -1017, -1017, -1017, -1018, -1018, -1018, -1018, -1018, -1019, -1019, -1019, -1019, -1019, -1020, -1020, -1020, -1020, -1020, -1020, -1020, -1021, -1021, -1021, -1021, -1021, -1021, -1021, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1022, -1021, -1021, -1021, -1021, -1021, -1021, -1021, -1020, -1020, -1020, -1020, -1020, -1020, -1020, -1019, -1019, -1019, -1019, -1019, -1019, -1018, -1018, -1018, -1018, -1018, -1017, -1017, -1017, -1017, -1016, -1016, -1016, -1016, -1016, -1015, -1015, -1015, -1015, -1014, -1014, -1014, -1014, -1013, -1013, -1013, -1013, -1012, -1012, -1012, -1012, -1011, -1011, -1011, -1010, -1010, -1010, -1010, -1009, -1009, -1009, -1008, -1008, -1008, -1007, -1007, -1007, -1006, -1006, -1006, -1005, -1005, -1005, -1004, -1004, -1004, -1003, -1003, -1003, -1002, -1002, -1001, -1001, -1001, -1000, -1000, -1000, -999, -999, -998, -998, -998, -997, -997, -996, -996, -996, -995, -995, -994, -994, -993, -993, -993, -992, -992, -991, -991, -990, -990, -989, -989, -988, -988, -988, -987, -987, -986, -986, -985, -985, -984, -984, -983, -983, -982, -982, -981, -981, -980, -980, -979, -979, -978, -977, -977, -976, -976, -975, -975, -974, -974, -973, -973, -972, -971, -971, -970, -970, -969, -969, -968, -967, -967, -966, -966, -965, -964, -964, -963, -963, -962, -961, -961, -960, -960, -959, -958, -958, -957, -956, -956, -955, -954, -954, -953, -952, -952, -951, -950, -950, -949, -948, -948, -947, -946, -946, -945, -944, -944, -943, -942, -942, -941, -940, -939, -939, -938, -937, -937, -936, -935, -934, -934, -933, -932, -931, -931, -930, -929, -928, -928, -927, -926, -925, -925, -924, -923, -922, -922, -921, -920, -919, -918, -918, -917, -916, -915, -914, -914, -913, -912, -911, -910, -910, -909, -908, -907, -906, -905, -905, -904, -903, -902, -901, -900, -900, -899, -898, -897, -896, -895, -894, -893, -893, -892, -891, -890, -889, -888, -887, -886, -886, -885, -884, -883, -882, -881, -880, -879, -878, -877, -876, -875, -875, -874, -873, -872, -871, -870, -869, -868, -867, -866, -865, -864, -863, -862, -861, -860, -859, -858, -857, -856, -855, -854, -853, -852, -851, -850, -849, -848, -847, -846, -845, -844, -843, -842, -841, -840, -839, -838, -837, -836, -835, -834, -833, -832, -831, -830, -829, -828, -827, -826, -825, -824, -823, -822, -821, -819, -818, -817, -816, -815, -814, -813, -812, -811, -810, -809, -807, -806, -805, -804, -803, -802, -801, -800, -799, -797, -796, -795, -794, -793, -792, -791, -790, -788, -787, -786, -785, -784, -783, -782, -780, -779, -778, -777, -776, -775, -773, -772, -771, -770, -769, -768, -766, -765, -764, -763, -762, -760, -759, -758, -757, -756, -754, -753, -752, -751, -750, -748, -747, -746, -745, -743, -742, -741, -740, -738, -737, -736, -735, -733, -732, -731, -730, -728, -727, -726, -725, -723, -722, -721, -720, -718, -717, -716, -715, -713, -712, -711, -709, -708, -707, -706, -704, -703, -702, -700, -699, -698, -696, -695, -694, -692, -691, -690, -688, -687, -686, -685, -683, -682, -681, -679, -678, -676, -675, -674, -672, -671, -670, -668, -667, -666, -664, -663, -662, -660, -659, -658, -656, -655, -653, -652, -651, -649, -648, -646, -645, -644, -642, -641, -640, -638, -637, -635, -634, -633, -631, -630, -628, -627, -625, -624, -623, -621, -620, -618, -617, -616, -614, -613, -611, -610, -608, -607, -605, -604, -603, -601, -600, -598, -597, -595, -594, -592, -591, -589, -588, -587, -585, -584, -582, -581, -579, -578, -576, -575, -573, -572, -570, -569, -567, -566, -564, -563, -561, -560, -558, -557, -555, -554, -552, -551, -549, -548, -546, -545, -543, -542, -540, -539, -537, -536, -534, -533, -531, -530, -528, -527, -525, -523, -522, -520, -519, -517, -516, -514, -513, -511, -510, -508, -507, -505, -503, -502, -500, -499, -497, -496, -494, -492, -491, -489, -488, -486, -485, -483, -481, -480, -478, -477, -475, -474, -472, -470, -469, -467, -466, -464, -462, -461, -459, -458, -456, -454, -453, -451, -450, -448, -446, -445, -443, -442, -440, -438, -437, -435, -433, -432, -430, -429, -427, -425, -424, -422, -420, -419, -417, -416, -414, -412, -411, -409, -407, -406, -404, -402, -401, -399, -398, -396, -394, -393, -391, -389, -388, -386, -384, -383, -381, -379, -378, -376, -374, -373, -371, -369, -368, -366, -364, -363, -361, -359, -358, -356, -354, -353, -351, -349, -348, -346, -344, -343, -341, -339, -337, -336, -334, -332, -331, -329, -327, -326, -324, -322, -321, -319, -317, -315, -314, -312, -310, -309, -307, -305, -304, -302, -300, -298, -297, -295, -293, -292, -290, -288, -286, -285, -283, -281, -280, -278, -276, -274, -273, -271, -269, -267, -266, -264, -262, -261, -259, -257, -255, -254, -252, -250, -248, -247, -245, -243, -241, -240, -238, -236, -235, -233, -231, -229, -228, -226, -224, -222, -221, -219, -217, -215, -214, -212, -210, -208, -207, -205, -203, -201, -200, -198, -196, -194, -193, -191, -189, -187, -186, -184, -182, -180, -179, -177, -175, -173, -171, -170, -168, -166, -164, -163, -161, -159, -157, -156, -154, -152, -150, -149, -147, -145, -143, -141, -140, -138, -136, -134, -133, -131, -129, -127, -125, -124, -122, -120, -118, -117, -115, -113, -111, -110, -108, -106, -104, -102, -101, -99, -97, -95, -93, -92, -90, -88, -86, -85, -83, -81, -79, -77, -76, -74, -72, -70, -69, -67, -65, -63, -61, -60, -58, -56, -54, -52, -51, -49, -47, -45, -44, -42, -40, -38, -36, -35, -33, -31, -29, -27, -26, -24, -22, -20, -19, -17, -15, -13, -11, -10, -8, -6, -4, -2, -1, 1, 3, 5, 6, 8, 10, 12, 14, 15, 17, 19, 21, 23, 24, 26, 28, 30, 32, 33, 35, 37, 39, 40, 42, 44, 46, 48, 49, 51, 53, 55, 57, 58, 60, 62, 64, 65, 67, 69, 71, 73, 74, 76, 78, 80, 81, 83, 85, 87, 89, 90, 92, 94, 96, 98, 99, 101, 103, 105, 106, 108, 110, 112, 114, 115, 117, 119, 121, 122, 124, 126, 128, 129, 131, 133, 135, 137, 138, 140, 142, 144, 145, 147, 149, 151, 153, 154, 156, 158, 160, 161, 163, 165, 167, 168, 170, 172, 174, 175, 177, 179, 181, 182, 184, 186, 188, 190, 191, 193, 195, 197, 198, 200, 202, 204, 205, 207, 209, 211, 212, 214, 216, 218, 219, 221, 223, 225, 226, 228, 230, 232, 233, 235, 237, 238, 240, 242, 244, 245, 247, 249, 251, 252, 254, 256, 258, 259, 261, 263, 264, 266, 268, 270, 271, 273, 275, 277, 278, 280, 282, 283, 285, 287, 289, 290, 292, 294, 295, 297, 299, 301, 302, 304, 306, 307, 309, 311, 312, 314, 316, 318, 319, 321, 323, 324, 326, 328, 329, 331, 333, 335, 336, 338, 340, 341, 343, 345, 346, 348, 350, 351, 353, 355, 356, 358, 360, 361, 363, 365, 366, 368, 370, 371, 373, 375, 376, 378, 380, 381, 383, 385, 386, 388, 390, 391, 393, 395, 396, 398, 400, 401, 403, 405, 406, 408, 409, 411, 413, 414, 416, 418, 419, 421, 423, 424, 426, 427, 429, 431, 432, 434, 436, 437, 439, 440, 442, 444, 445, 447, 448, 450, 452, 453, 455, 456, 458, 460, 461, 463, 464, 466, 468, 469, 471, 472, 474, 476, 477, 479, 480, 482, 483, 485, 487, 488, 490, 491, 493, 494, 496, 498, 499, 501, 502, 504, 505, 507, 508, 510, 512, 513, 515, 516, 518, 519, 521, 522, 524, 525, 527, 528, 530, 532, 533, 535, 536, 538, 539, 541, 542, 544, 545, 547, 548, 550, 551, 553, 554, 556, 557, 559, 560, 562, 563, 565, 566, 568, 569, 571, 572, 574, 575, 577, 578, 580, 581, 583, 584, 585, 587, 588, 590, 591, 593, 594, 596, 597, 599, 600, 601, 603, 604, 606, 607, 609, 610, 612, 613, 614, 616, 617, 619, 620, 622, 623, 624, 626, 627, 629, 630, 631, 633, 634, 636, 637, 638, 640, 641, 643, 644, 645, 647, 648, 650, 651, 652, 654, 655, 656, 658, 659, 661, 662, 663, 665, 666, 667, 669, 670, 671, 673, 674, 675, 677, 678, 680, 681, 682, 684, 685, 686, 688, 689, 690, 691, 693, 694, 695, 697, 698, 699, 701, 702, 703, 705, 706, 707, 708, 710, 711, 712, 714, 715, 716, 717, 719, 720, 721, 722, 724, 725, 726, 728, 729, 730, 731, 733, 734, 735, 736, 738, 739, 740, 741, 742, 744, 745, 746, 747, 749, 750, 751, 752, 753, 755, 756, 757, 758, 759, 761, 762, 763, 764, 765, 767, 768, 769, 770, 771, 773, 774, 775, 776, 777, 778, 780, 781, 782, 783, 784, 785, 786, 788, 789, 790, 791, 792, 793, 794, 796, 797, 798, 799, 800, 801, 802, 803, 804, 806, 807, 808, 809, 810, 811, 812, 813, 814, 815, 816, 818, 819, 820, 821, 822, 823, 824, 825, 826, 827, 828, 829, 830, 831, 832, 833, 834, 835, 837, 838, 839, 840, 841, 842, 843, 844, 845, 846, 847, 848, 849, 850, 851, 852, 853, 854, 855, 856, 857, 858, 859, 860, 861, 862, 862, 863, 864, 865, 866, 867, 868, 869, 870, 871, 872, 873, 874, 875, 876, 877, 878, 878, 879, 880, 881, 882, 883, 884, 885, 886, 887, 888, 888, 889, 890, 891, 892, 893, 894, 895, 895, 896, 897, 898, 899, 900, 901, 901, 902, 903, 904, 905, 906, 906, 907, 908, 909, 910, 911, 911, 912, 913, 914, 915, 915, 916, 917, 918, 919, 919, 920, 921, 922, 923, 923, 924, 925, 926, 926, 927, 928, 929, 929, 930, 931, 932, 932, 933, 934, 935, 935, 936, 937, 938, 938, 939, 940, 940, 941, 942, 942, 943, 944, 945, 945, 946, 947, 947, 948, 949, 949, 950, 951, 951, 952, 953, 953, 954, 955, 955, 956, 957, 957, 958, 958, 959, 960, 960, 961, 962, 962, 963, 963, 964, 965, 965, 966, 966, 967, 968, 968, 969, 969, 970, 970, 971, 972, 972, 973, 973, 974, 974, 975, 975, 976, 977, 977, 978, 978, 979, 979, 980, 980, 981, 981, 982, 982, 983, 983, 984, 984, 985, 985, 986, 986, 987, 987, 988, 988, 989, 989, 989, 990, 990, 991, 991, 992, 992, 993, 993, 994, 994, 994, 995, 995, 996, 996, 996, 997, 997, 998, 998, 998, 999, 999, 1000, 1000, 1000, 1001, 1001, 1002, 1002, 1002, 1003, 1003, 1003, 1004, 1004, 1004, 1005, 1005, 1005, 1006, 1006, 1006, 1007, 1007, 1007, 1008, 1008, 1008, 1009, 1009, 1009, 1010, 1010, 1010, 1010, 1011, 1011, 1011, 1012, 1012, 1012, 1012, 1013, 1013, 1013, 1013, 1014, 1014, 1014, 1014, 1015, 1015, 1015, 1015, 1016, 1016, 1016, 1016, 1017, 1017, 1017, 1017, 1017, 1018, 1018, 1018, 1018, 1018, 1019, 1019, 1019, 1019, 1019, 1019, 1020, 1020, 1020, 1020, 1020, 1020, 1021, 1021, 1021, 1021, 1021, 1021, 1021, 1021, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1022, 1021, 1021, 1021, 1021, 1021, 1021, 1021, 1020, 1020, 1020, 1020, 1020, 1020, 1019, 1019, 1019, 1019, 1019, 1019, 1018, 1018, 1018, 1018, 1018, 1017, 1017, 1017, 1017, 1017, 1016, 1016, 1016, 1016, 1015, 1015, 1015, 1015, 1015, 1014, 1014, 1014, 1014, 1013, 1013, 1013, 1013, 1012, 1012, 1012, 1011, 1011, 1011, 1011, 1010, 1010, 1010, 1009, 1009, 1009, 1008, 1008, 1008, 1008, 1007, 1007, 1007, 1006, 1006, 1006, 1005, 1005, 1005, 1004, 1004, 1003, 1003, 1003, 1002, 1002, 1002, 1001, 1001, 1001, 1000, 1000, 999, 999, 999, 998, 998, 997, 997, 997, 996, 996, 995, 995, 994, 994, 994, 993, 993, 992, 992, 991, 991, 991, 990, 990, 989, 989, 988, 988, 987, 987, 986, 986, 985, 985, 984, 984, 983, 983, 982, 982, 981, 981, 980, 980, 979, 979, 978, 978, 977, 977, 976, 976, 975, 974, 974, 973, 973, 972, 972, 971, 971, 970, 969, 969, 968, 968, 967, 966, 966, 965, 965, 964, 964, 963, 962, 962, 961, 960, 960, 959, 959, 958, 957, 957, 956, 955, 955, 954, 953, 953, 952, 951, 951, 950, 949, 949, 948, 947, 947, 946, 945, 945, 944, 943, 943, 942, 941, 941, 940, 939, 938, 938, 937, 936, 936, 935, 934, 933, 933, 932, 931, 930, 930, 929, 928, 927, 927, 926, 925, 924, 924, 923, 922, 921, 920, 920, 919, 918, 917, 916, 916, 915, 914, 913, 912, 912, 911, 910, 909, 908, 908, 907, 906, 905, 904, 903, 902, 902, 901, 900, 899, 898, 897, 897, 896, 895, 894, 893, 892, 891, 890, 890, 889, 888, 887, 886, 885, 884, 883, 882, 881, 881, 880, 879, 878, 877, 876, 875, 874, 873, 872, 871, 870, 869, 868, 867, 867, 866, 865, 864, 863, 862, 861, 860, 859, 858, 857, 856, 855, 854, 853, 852, 851, 850, 849, 848, 847, 846, 845, 844, 843, 842, 841, 840, 839, 838, 837, 836, 835, 834, 833, 832, 831, 830, 828, 827, 826, 825, 824, 823, 822, 821, 820, 819, 818, 817, 816, 815, 814, 812, 811, 810, 809, 808, 807, 806, 805, 804, 803, 801, 800, 799, 798, 797, 796, 795, 794, 792, 791, 790, 789, 788, 787, 786, 784, 783, 782, 781, 780, 779, 778, 776, 775, 774, 773, 772, 770, 769, 768, 767, 766, 765, 763, 762, 761, 760, 759, 757, 756, 755, 754, 753, 751, 750, 749, 748, 746, 745, 744, 743, 742, 740, 739, 738, 737, 735, 734, 733, 732, 730, 729, 728, 727, 725, 724,
                                                  };
/*
// uncomment this line if you're using an 400 steps/rev motor and comment out those above
const PROGMEM int_fast16_t sine_lookup_coil_A[] = {724, 727, 729, 732, 734, 737, 739, 742, 744, 746, 749, 751, 754, 756, 759, 761, 763, 766, 768, 770, 773, 775, 778, 780, 782, 784, 787, 789, 791, 794, 796, 798, 800, 803, 805, 807, 809, 811, 814, 816, 818, 820, 822, 824, 826, 828, 831, 833, 835, 837, 839, 841, 843, 845, 847, 849, 851, 853, 855, 857, 859, 861, 863, 865, 867, 868, 870, 872, 874, 876, 878, 880, 881, 883, 885, 887, 889, 890, 892, 894, 896, 897, 899, 901, 902, 904, 906, 908, 909, 911, 912, 914, 916, 917, 919, 920, 922, 924, 925, 927, 928, 930, 931, 933, 934, 936, 937, 938, 940, 941, 943, 944, 945, 947, 948, 949, 951, 952, 953, 955, 956, 957, 959, 960, 961, 962, 964, 965, 966, 967, 968, 969, 971, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 994, 995, 996, 997, 998, 999, 999, 1000, 1001, 1002, 1002, 1003, 1004, 1005, 1005, 1006, 1007, 1007, 1008, 1008, 1009, 1010, 1010, 1011, 1011, 1012, 1013, 1013, 1014, 1014, 1015, 1015, 1015, 1016, 1016, 1017, 1017, 1018, 1018, 1018, 1019, 1019, 1019, 1020, 1020, 1020, 1021, 1021, 1021, 1022, 1022, 1022, 1022, 1022, 1023, 1023, 1023, 1023, 1023, 1023, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1022, 1022, 1022, 1022, 1021, 1021, 1021, 1021, 1020, 1020, 1020, 1019, 1019, 1019, 1018, 1018, 1018, 1017, 1017, 1016, 1016, 1015, 1015, 1014, 1014, 1013, 1013, 1012, 1012, 1011, 1011, 1010, 1010, 1009, 1008, 1008, 1007, 1006, 1006, 1005, 1004, 1004, 1003, 1002, 1002, 1001, 1000, 999, 998, 998, 997, 996, 995, 994, 994, 993, 992, 991, 990, 989, 988, 987, 986, 985, 984, 983, 982, 981, 980, 979, 978, 977, 976, 975, 974, 973, 972, 970, 969, 968, 967, 966, 965, 963, 962, 961, 960, 958, 957, 956, 955, 953, 952, 951, 949, 948, 947, 945, 944, 942, 941, 940, 938, 937, 935, 934, 932, 931, 929, 928, 926, 925, 923, 922, 920, 919, 917, 915, 914, 912, 911, 909, 907, 906, 904, 902, 901, 899, 897, 895, 894, 892, 890, 888, 887, 885, 883, 881, 879, 878, 876, 874, 872, 870, 868, 866, 864, 862, 861, 859, 857, 855, 853, 851, 849, 847, 845, 843, 841, 839, 837, 834, 832, 830, 828, 826, 824, 822, 820, 818, 815, 813, 811, 809, 807, 804, 802, 800, 798, 796, 793, 791, 789, 786, 784, 782, 780, 777, 775, 773, 770, 768, 765, 763, 761, 758, 756, 753, 751, 749, 746, 744, 741, 739, 736, 734, 731, 729, 726, 724, 721, 719, 716, 714, 711, 708, 706, 703, 701, 698, 695, 693, 690, 687, 685, 682, 680, 677, 674, 671, 669, 666, 663, 661, 658, 655, 652, 650, 647, 644, 641, 638, 636, 633, 630, 627, 624, 622, 619, 616, 613, 610, 607, 604, 601, 599, 596, 593, 590, 587, 584, 581, 578, 575, 572, 569, 566, 563, 560, 557, 554, 551, 548, 545, 542, 539, 536, 533, 530, 527, 524, 521, 518, 515, 512, 508, 505, 502, 499, 496, 493, 490, 487, 483, 480, 477, 474, 471, 468, 464, 461, 458, 455, 452, 448, 445, 442, 439, 436, 432, 429, 426, 423, 419, 416, 413, 409, 406, 403, 400, 396, 393, 390, 386, 383, 380, 376, 373, 370, 366, 363, 360, 356, 353, 350, 346, 343, 340, 336, 333, 329, 326, 323, 319, 316, 312, 309, 306, 302, 299, 295, 292, 289, 285, 282, 278, 275, 271, 268, 264, 261, 258, 254, 251, 247, 244, 240, 237, 233, 230, 226, 223, 219, 216, 212, 209, 205, 202, 198, 195, 191, 188, 184, 181, 177, 174, 170, 167, 163, 160, 156, 153, 149, 145, 142, 138, 135, 131, 128, 124, 121, 117, 114, 110, 106, 103, 99, 96, 92, 89, 85, 81, 78, 74, 71, 67, 64, 60, 57, 53, 49, 46, 42, 39, 35, 32, 28, 24, 21, 17, 14, 10, 6, 3, -1, -4, -8, -11, -15, -19, -22, -26, -29, -33, -36, -40, -44, -47, -51, -54, -58, -61, -65, -69, -72, -76, -79, -83, -86, -90, -94, -97, -101, -104, -108, -111, -115, -118, -122, -125, -129, -133, -136, -140, -143, -147, -150, -154, -157, -161, -164, -168, -171, -175, -179, -182, -186, -189, -193, -196, -200, -203, -207, -210, -214, -217, -221, -224, -228, -231, -235, -238, -242, -245, -248, -252, -255, -259, -262, -266, -269, -273, -276, -280, -283, -286, -290, -293, -297, -300, -304, -307, -310, -314, -317, -321, -324, -327, -331, -334, -337, -341, -344, -348, -351, -354, -358, -361, -364, -368, -371, -374, -378, -381, -384, -388, -391, -394, -398, -401, -404, -407, -411, -414, -417, -420, -424, -427, -430, -433, -437, -440, -443, -446, -450, -453, -456, -459, -462, -466, -469, -472, -475, -478, -481, -485, -488, -491, -494, -497, -500, -503, -507, -510, -513, -516, -519, -522, -525, -528, -531, -534, -537, -540, -543, -546, -549, -552, -555, -558, -561, -564, -567, -570, -573, -576, -579, -582, -585, -588, -591, -594, -597, -600, -603, -605, -608, -611, -614, -617, -620, -623, -625, -628, -631, -634, -637, -640, -642, -645, -648, -651, -653, -656, -659, -662, -664, -667, -670, -672, -675, -678, -681, -683, -686, -688, -691, -694, -696, -699, -702, -704, -707, -709, -712, -715, -717, -720, -722, -725, -727, -730, -732, -735, -737, -740, -742, -745, -747, -750, -752, -754, -757, -759, -762, -764, -766, -769, -771, -773, -776, -778, -780, -783, -785, -787, -790, -792, -794, -796, -799, -801, -803, -805, -807, -810, -812, -814, -816, -818, -821, -823, -825, -827, -829, -831, -833, -835, -837, -839, -841, -843, -845, -847, -849, -851, -853, -855, -857, -859, -861, -863, -865, -867, -869, -871, -873, -875, -876, -878, -880, -882, -884, -886, -887, -889, -891, -893, -894, -896, -898, -900, -901, -903, -905, -906, -908, -910, -911, -913, -914, -916, -918, -919, -921, -922, -924, -925, -927, -928, -930, -931, -933, -934, -936, -937, -939, -940, -942, -943, -944, -946, -947, -948, -950, -951, -952, -954, -955, -956, -958, -959, -960, -961, -963, -964, -965, -966, -967, -969, -970, -971, -972, -973, -974, -975, -976, -977, -979, -980, -981, -982, -983, -984, -985, -986, -987, -988, -988, -989, -990, -991, -992, -993, -994, -995, -996, -996, -997, -998, -999, -1000, -1000, -1001, -1002, -1003, -1003, -1004, -1005, -1005, -1006, -1007, -1007, -1008, -1009, -1009, -1010, -1010, -1011, -1012, -1012, -1013, -1013, -1014, -1014, -1015, -1015, -1016, -1016, -1016, -1017, -1017, -1018, -1018, -1019, -1019, -1019, -1020, -1020, -1020, -1020, -1021, -1021, -1021, -1022, -1022, -1022, -1022, -1022, -1023, -1023, -1023, -1023, -1023, -1023, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1022, -1022, -1022, -1022, -1021, -1021, -1021, -1021, -1020, -1020, -1020, -1019, -1019, -1019, -1018, -1018, -1017, -1017, -1017, -1016, -1016, -1015, -1015, -1014, -1014, -1013, -1013, -1012, -1012, -1011, -1011, -1010, -1009, -1009, -1008, -1008, -1007, -1006, -1006, -1005, -1004, -1004, -1003, -1002, -1001, -1001, -1000, -999, -998, -997, -997, -996, -995, -994, -993, -992, -992, -991, -990, -989, -988, -987, -986, -985, -984, -983, -982, -981, -980, -979, -978, -977, -976, -975, -974, -972, -971, -970, -969, -968, -967, -965, -964, -963, -962, -961, -959, -958, -957, -956, -954, -953, -952, -950, -949, -948, -946, -945, -944, -942, -941, -939, -938, -936, -935, -934, -932, -931, -929, -928, -926, -924, -923, -921, -920, -918, -917, -915, -913, -912, -910, -909, -907, -905, -904, -902, -900, -898, -897, -895, -893, -892, -890, -888, -886, -884, -883, -881, -879, -877, -875, -873, -871, -870, -868, -866, -864, -862, -860, -858, -856, -854, -852, -850, -848, -846, -844, -842, -840, -838, -836, -834, -832, -830, -828, -826, -823, -821, -819, -817, -815, -813, -811, -808, -806, -804, -802, -799, -797, -795, -793, -790, -788, -786, -784, -781, -779, -777, -774, -772, -770, -767, -765, -762, -760, -758, -755, -753, -750, -748, -746, -743, -741, -738, -736, -733, -731, -728, -726, -723, -721, -718, -715, -713, -710, -708, -705, -703, -700, -697, -695, -692, -689, -687, -684, -682, -679, -676, -673, -671, -668, -665, -663, -660, -657, -654, -652, -649, -646, -643, -641, -638, -635, -632, -629, -627, -624, -621, -618, -615, -612, -609, -607, -604, -601, -598, -595, -592, -589, -586, -583, -580, -577, -574, -571, -568, -566, -563, -560, -557, -554, -551, -547, -544, -541, -538, -535, -532, -529, -526, -523, -520, -517, -514, -511, -508, -505, -501, -498, -495, -492, -489, -486, -483, -479, -476, -473, -470, -467, -464, -460, -457, -454, -451, -448, -444, -441, -438, -435, -431, -428, -425, -422, -418, -415, -412, -409, -405, -402, -399, -395, -392, -389, -386, -382, -379, -376, -372, -369, -366, -362, -359, -356, -352, -349, -345, -342, -339, -335, -332, -329, -325, -322, -318, -315, -312, -308, -305, -301, -298, -295, -291, -288, -284, -281, -277, -274, -270, -267, -264, -260, -257, -253, -250, -246, -243, -239, -236, -232, -229, -225, -222, -218, -215, -211, -208, -204, -201, -197, -194, -190, -187, -183, -180, -176, -173, -169, -166, -162, -159, -155, -152, -148, -145, -141, -137, -134, -130, -127, -123, -120, -116, -113, -109, -106, -102, -98, -95, -91, -88, -84, -81, -77, -73, -70, -66, -63, -59, -56, -52, -48, -45, -41, -38, -34, -31, -27, -23, -20, -16, -13, -9, -6, -2, 2, 5, 9, 12, 16, 19, 23, 27, 30, 34, 37, 41, 44, 48, 52, 55, 59, 62, 66, 69, 73, 77, 80, 84, 87, 91, 94, 98, 102, 105, 109, 112, 116, 119, 123, 126, 130, 133, 137, 141, 144, 148, 151, 155, 158, 162, 165, 169, 172, 176, 179, 183, 186, 190, 193, 197, 200, 204, 207, 211, 214, 218, 221, 225, 228, 232, 235, 239, 242, 246, 249, 253, 256, 260, 263, 267, 270, 274, 277, 280, 284, 287, 291, 294, 298, 301, 304, 308, 311, 315, 318, 321, 325, 328, 332, 335, 338, 342, 345, 348, 352, 355, 359, 362, 365, 369, 372, 375, 379, 382, 385, 388, 392, 395, 398, 402, 405, 408, 411, 415, 418, 421, 425, 428, 431, 434, 438, 441, 444, 447, 450, 454, 457, 460, 463, 466, 470, 473, 476, 479, 482, 485, 489, 492, 495, 498, 501, 504, 507, 510, 513, 517, 520, 523, 526, 529, 532, 535, 538, 541, 544, 547, 550, 553, 556, 559, 562, 565, 568, 571, 574, 577, 580, 583, 586, 589, 592, 595, 598, 600, 603, 606, 609, 612, 615, 618, 621, 623, 626, 629, 632, 635, 637, 640, 643, 646, 649, 651, 654, 657, 660, 662, 665, 668, 670, 673, 676, 679, 681, 684, 687, 689, 692, 694, 697, 700, 702, 705, 707, 710, 713, 715, 718, 720, 723, 725, 728, 730, 733, 735, 738, 740, 743, 745, 748, 750, 753, 755, 757, 760, 762, 765, 767, 769, 772, 774, 776, 779, 781, 783, 786, 788, 790, 792, 795, 797, 799, 801, 804, 806, 808, 810, 812, 815, 817, 819, 821, 823, 825, 827, 830, 832, 834, 836, 838, 840, 842, 844, 846, 848, 850, 852, 854, 856, 858, 860, 862, 864, 866, 867, 869, 871, 873, 875, 877, 879, 881, 882, 884, 886, 888, 890, 891, 893, 895, 897, 898, 900, 902, 903, 905, 907, 908, 910, 912, 913, 915, 916, 918, 920, 921, 923, 924, 926, 927, 929, 930, 932, 933, 935, 936, 938, 939, 941, 942, 943, 945, 946, 947, 949, 950, 951, 953, 954, 955, 957, 958, 959, 960, 962, 963, 964, 965, 966, 968, 969, 970, 971, 972, 973, 974, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 991, 992, 993, 994, 995, 996, 997, 997, 998, 999, 1000, 1001, 1001, 1002, 1003, 1003, 1004, 1005, 1006, 1006, 1007, 1008, 1008, 1009, 1009, 1010, 1011, 1011, 1012, 1012, 1013, 1013, 1014, 1014, 1015, 1015, 1016, 1016, 1017, 1017, 1017, 1018, 1018, 1019, 1019, 1019, 1020, 1020, 1020, 1021, 1021, 1021, 1021, 1022, 1022, 1022, 1022, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 1023, 1023, 1023, 1023, 1023, 1022, 1022, 1022, 1022, 1022, 1021, 1021, 1021, 1021, 1020, 1020, 1020, 1019, 1019, 1019, 1018, 1018, 1017, 1017, 1017, 1016, 1016, 1015, 1015, 1014, 1014, 1013, 1013, 1012, 1012, 1011, 1010, 1010, 1009, 1009, 1008, 1007, 1007, 1006, 1005, 1005, 1004, 1003, 1003, 1002, 1001, 1000, 1000, 999, 998, 997, 996, 996, 995, 994, 993, 992, 991, 990, 989, 989, 988, 987, 986, 985, 984, 983, 982, 981, 980, 979, 978, 977, 975, 974, 973, 972, 971, 970, 969, 968, 966, 965, 964, 963, 962, 960, 959, 958, 957, 955, 954, 953, 951, 950, 949, 947, 946, 945, 943, 942, 940, 939, 938, 936, 935, 933, 932, 930, 929, 927, 926, 924, 923, 921, 919, 918, 916, 915, 913, 911, 910, 908, 906, 905, 903, 901, 900, 898, 896, 895, 893, 891, 889, 888, 886, 884, 882, 880, 878, 877, 875, 873, 871, 869, 867, 865, 863, 861, 860, 858, 856, 854, 852, 850, 848, 846, 844, 842, 840, 838, 835, 833, 831, 829, 827, 825, 823, 821, 819, 816, 814, 812, 810, 808, 806, 803, 801, 799, 797, 794, 792, 790, 788, 785, 783, 781, 778, 776, 774, 771, 769, 767, 764, 762, 759, 757, 755, 752, 750, 747, 745, 742, 740, 738, 735, 733, 730, 728, 725, 722, 720, 717, 715, 712, 710, 707, 705, 702, 699, 697, 694, 691, 689, 686, 684, 681, 678, 675, 673, 670, 667, 665, 662, 659, 656, 654, 651, 648, 645, 643, 640, 637, 634, 631, 629, 626, 623, 620, 617, 614, 612, 609, 606, 603, 600, 597, 594, 591, 588, 585, 583, 580, 577, 574, 571, 568, 565, 562, 559, 556, 553, 550, 547, 544, 541, 538, 535, 532, 528, 525, 522, 519, 516, 513, 510, 507, 504, 501, 498, 494, 491, 488, 485, 482, 479, 476, 472, 469, 466, 463, 460, 456, 453, 450, 447, 444, 440, 437, 434, 431, 427, 424, 421, 418, 414, 411, 408, 405, 401, 398, 395, 391, 388, 385, 381, 378, 375, 371, 368, 365, 361, 358, 355, 351, 348, 345, 341, 338, 335, 331, 328, 324, 321, 318, 314, 311, 307, 304, 301, 297, 294, 290, 287, 283, 280, 277, 273, 270, 266, 263, 259, 256, 252, 249, 245, 242, 238, 235, 231, 228, 225, 221, 218, 214, 211, 207, 204, 200, 197, 193, 190, 186, 182, 179, 175, 172, 168, 165, 161, 158, 154, 151, 147, 144, 140, 137, 133, 129, 126, 122, 119, 115, 112, 108, 105, 101, 98, 94, 90, 87, 83, 80, 76, 73, 69, 65, 62, 58, 55, 51, 48, 44, 40, 37, 33, 30, 26, 23, 19, 15, 12, 8, 5, 1, -2, -6, -10, -13, -17, -20, -24, -27, -31, -35, -38, -42, -45, -49, -52, -56, -60, -63, -67, -70, -74, -77, -81, -85, -88, -92, -95, -99, -102, -106, -110, -113, -117, -120, -124, -127, -131, -134, -138, -141, -145, -149, -152, -156, -159, -163, -166, -170, -173, -177, -180, -184, -187, -191, -194, -198, -201, -205, -208, -212, -215, -219, -222, -226, -229, -233, -236, -240, -243, -247, -250, -254, -257, -261, -264, -267, -271, -274, -278, -281, -285, -288, -292, -295, -298, -302, -305, -309, -312, -315, -319, -322, -326, -329, -332, -336, -339, -343, -346, -349, -353, -356, -359, -363, -366, -369, -373, -376, -379, -383, -386, -389, -393, -396, -399, -402, -406, -409, -412, -416, -419, -422, -425, -429, -432, -435, -438, -442, -445, -448, -451, -454, -458, -461, -464, -467, -470, -474, -477, -480, -483, -486, -489, -492, -496, -499, -502, -505, -508, -511, -514, -517, -520, -524, -527, -530, -533, -536, -539, -542, -545, -548, -551, -554, -557, -560, -563, -566, -569, -572, -575, -578, -581, -584, -587, -589, -592, -595, -598, -601, -604, -607, -610, -613, -616, -618, -621, -624, -627, -630, -633, -635, -638, -641, -644, -646, -649, -652, -655, -658, -660, -663, -666, -668, -671, -674, -677, -679, -682, -685, -687, -690, -692, -695, -698, -700, -703, -706, -708, -711, -713, -716, -718, -721, -723, -726, -728, -731, -733, -736, -738, -741, -743, -746, -748, -751, -753, -756, -758, -760, -763, -765, -768, -770, -772, -775, -777, -779, -782, -784, -786, -788, -791, -793, -795, -798, -800, -802, -804, -806, -809, -811, -813, -815, -817, -819, -822, -824, -826, -828, -830, -832, -834, -836, -838, -840, -842, -844, -846, -848, -850, -852, -854, -856, -858, -860, -862, -864, -866, -868, -870, -872, -874, -875, -877, -879, -881, -883, -885, -886, -888, -890, -892, -893, -895, -897, -899, -900, -902, -904, -905, -907, -909, -910, -912, -914, -915, -917, -918, -920, -922, -923, -925, -926, -928, -929, -931, -932, -934, -935, -937, -938, -939, -941, -942, -944, -945, -946, -948, -949, -950, -952, -953, -954, -956, -957, -958, -960, -961, -962, -963, -964, -966, -967, -968, -969, -970, -971, -973, -974, -975, -976, -977, -978, -979, -980, -981, -982, -983, -984, -985, -986, -987, -988, -989, -990, -991, -992, -993, -993, -994, -995, -996, -997, -998, -998, -999, -1000, -1001, -1001, -1002, -1003, -1004, -1004, -1005, -1006, -1006, -1007, -1008, -1008, -1009, -1010, -1010, -1011, -1011, -1012, -1012, -1013, -1013, -1014, -1014, -1015, -1015, -1016, -1016, -1017, -1017, -1018, -1018, -1018, -1019, -1019, -1019, -1020, -1020, -1020, -1021, -1021, -1021, -1021, -1022, -1022, -1022, -1022, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1023, -1023, -1023, -1023, -1023, -1023, -1022, -1022, -1022, -1022, -1022, -1021, -1021, -1021, -1020, -1020, -1020, -1020, -1019, -1019, -1018, -1018, -1018, -1017, -1017, -1016, -1016, -1016, -1015, -1015, -1014, -1014, -1013, -1013, -1012, -1011, -1011, -1010, -1010, -1009, -1009, -1008, -1007, -1007, -1006, -1005, -1005, -1004, -1003, -1002, -1002, -1001, -1000, -999, -999, -998, -997, -996, -995, -995, -994, -993, -992, -991, -990, -989, -988, -987, -986, -985, -984, -984, -983, -981, -980, -979, -978, -977, -976, -975, -974, -973, -972, -971, -970, -968, -967, -966, -965, -964, -962, -961, -960, -959, -957, -956, -955, -954, -952, -951, -950, -948, -947, -946, -944, -943, -941, -940, -939, -937, -936, -934, -933, -931, -930, -928, -927, -925, -924, -922, -921, -919, -917, -916, -914, -913, -911, -909, -908, -906, -904, -903, -901, -899, -898, -896, -894, -892, -891, -889, -887, -885, -883, -882, -880, -878, -876, -874, -872, -871, -869, -867, -865, -863, -861, -859, -857, -855, -853, -851, -849, -847, -845, -843, -841, -839, -837, -835, -833, -831, -829, -827, -825, -822, -820, -818, -816, -814, -812, -809, -807, -805, -803, -801, -798, -796, -794, -792, -789, -787, -785, -782, -780, -778, -775, -773, -771, -768, -766, -764, -761, -759, -756, -754, -752, -749, -747, -744, -742, -739, -737, -734, -732, -729, -727, -724, -722, -719, -717, -714, -712, -709, -706, -704, -701, -699, -696, -693, -691, -688, -686, -683, -680, -678, -675, -672, -669, -667, -664, -661, -659, -656, -653, -650, -648, -645, -642, -639, -636, -634, -631, -628, -625, -622, -619, -617, -614, -611, -608, -605, -602, -599, -596, -594, -591, -588, -585, -582, -579, -576, -573, -570, -567, -564, -561, -558, -555, -552, -549, -546, -543, -540, -537, -534, -531, -528, -525, -522, -518, -515, -512, -509, -506, -503, -500, -497, -494, -490, -487, -484, -481, -478, -475, -472, -468, -465, -462, -459, -456, -452, -449, -446, -443, -440, -436, -433, -430, -427, -423, -420, -417, -414, -410, -407, -404, -400, -397, -394, -391, -387, -384, -381, -377, -374, -371, -367, -364, -361, -357, -354, -351, -347, -344, -340, -337, -334, -330, -327, -324, -320, -317, -313, -310, -307, -303, -300, -296, -293, -289, -286, -283, -279, -276, -272, -269, -265, -262, -258, -255, -251, -248, -245, -241, -238, -234, -231, -227, -224, -220, -217, -213, -210, -206, -203, -199, -196, -192, -189, -185, -182, -178, -175, -171, -168, -164, -160, -157, -153, -150, -146, -143, -139, -136, -132, -129, -125, -121, -118, -114, -111, -107, -104, -100, -97, -93, -89, -86, -82, -79, -75, -72, -68, -65, -61, -57, -54, -50, -47, -43, -40, -36, -32, -29, -25, -22, -18, -15, -11, -7, -4, 0, 3, 7, 11, 14, 18, 21, 25, 28, 32, 36, 39, 43, 46, 50, 53, 57, 61, 64, 68, 71, 75, 78, 82, 85, 89, 93, 96, 100, 103, 107, 110, 114, 118, 121, 125, 128, 132, 135, 139, 142, 146, 149, 153, 156, 160, 164, 167, 171, 174, 178, 181, 185, 188, 192, 195, 199, 202, 206, 209, 213, 216, 220, 223, 227, 230, 234, 237, 241, 244, 248, 251, 255, 258, 261, 265, 268, 272, 275, 279, 282, 286, 289, 292, 296, 299, 303, 306, 309, 313, 316, 320, 323, 326, 330, 333, 337, 340, 343, 347, 350, 353, 357, 360, 364, 367, 370, 374, 377, 380, 383, 387, 390, 393, 397, 400, 403, 407, 410, 413, 416, 420, 423, 426, 429, 433, 436, 439, 442, 446, 449, 452, 455, 458, 462, 465, 468, 471, 474, 478, 481, 484, 487, 490, 493, 496, 500, 503, 506, 509, 512, 515, 518, 521, 524, 527, 530, 533, 537, 540, 543, 546, 549, 552, 555, 558, 561, 564, 567, 570, 573, 576, 578, 581, 584, 587, 590, 593, 596, 599, 602, 605, 608, 611, 613, 616, 619, 622, 625, 628, 630, 633, 636, 639, 642, 644, 647, 650, 653, 655, 658, 661, 664, 666, 669, 672, 674, 677, 680, 683, 685, 688, 690, 693, 696, 698, 701, 704, 706, 709, 711, 714, 716, 719, 722, 724,
                                                  };
const PROGMEM int_fast16_t sine_lookup_coil_B[] = {724, 722, 719, 716, 714, 711, 709, 706, 704, 701, 698, 696, 693, 690, 688, 685, 683, 680, 677, 674, 672, 669, 666, 664, 661, 658, 655, 653, 650, 647, 644, 642, 639, 636, 633, 630, 628, 625, 622, 619, 616, 613, 610, 608, 605, 602, 599, 596, 593, 590, 587, 584, 581, 578, 576, 573, 570, 567, 564, 561, 558, 555, 552, 549, 546, 543, 540, 537, 533, 530, 527, 524, 521, 518, 515, 512, 509, 506, 503, 499, 496, 493, 490, 487, 484, 481, 477, 474, 471, 468, 465, 462, 458, 455, 452, 449, 446, 442, 439, 436, 433, 429, 426, 423, 420, 416, 413, 410, 407, 403, 400, 397, 393, 390, 387, 383, 380, 377, 374, 370, 367, 364, 360, 357, 353, 350, 347, 343, 340, 337, 333, 330, 326, 323, 320, 316, 313, 309, 306, 303, 299, 296, 292, 289, 286, 282, 279, 275, 272, 268, 265, 261, 258, 255, 251, 248, 244, 241, 237, 234, 230, 227, 223, 220, 216, 213, 209, 206, 202, 199, 195, 192, 188, 185, 181, 178, 174, 171, 167, 164, 160, 156, 153, 149, 146, 142, 139, 135, 132, 128, 125, 121, 118, 114, 110, 107, 103, 100, 96, 93, 89, 85, 82, 78, 75, 71, 68, 64, 61, 57, 53, 50, 46, 43, 39, 36, 32, 28, 25, 21, 18, 14, 10, 7, 3, 0, -4, -7, -11, -15, -18, -22, -25, -29, -32, -36, -40, -43, -47, -50, -54, -57, -61, -65, -68, -72, -75, -79, -82, -86, -90, -93, -97, -100, -104, -107, -111, -114, -118, -122, -125, -129, -132, -136, -139, -143, -146, -150, -153, -157, -160, -164, -168, -171, -175, -178, -182, -185, -189, -192, -196, -199, -203, -206, -210, -213, -217, -220, -224, -227, -231, -234, -238, -241, -245, -248, -251, -255, -258, -262, -265, -269, -272, -276, -279, -283, -286, -289, -293, -296, -300, -303, -307, -310, -313, -317, -320, -324, -327, -330, -334, -337, -340, -344, -347, -351, -354, -357, -361, -364, -367, -371, -374, -377, -381, -384, -387, -391, -394, -397, -400, -404, -407, -410, -414, -417, -420, -423, -427, -430, -433, -436, -440, -443, -446, -449, -452, -456, -459, -462, -465, -468, -472, -475, -478, -481, -484, -487, -491, -494, -497, -500, -503, -506, -509, -512, -515, -519, -522, -525, -528, -531, -534, -537, -540, -543, -546, -549, -552, -555, -558, -561, -564, -567, -570, -573, -576, -579, -582, -585, -588, -591, -594, -596, -599, -602, -605, -608, -611, -614, -617, -619, -622, -625, -628, -631, -634, -636, -639, -642, -645, -648, -650, -653, -656, -659, -661, -664, -667, -669, -672, -675, -678, -680, -683, -686, -688, -691, -693, -696, -699, -701, -704, -706, -709, -712, -714, -717, -719, -722, -724, -727, -729, -732, -734, -737, -739, -742, -744, -747, -749, -752, -754, -756, -759, -761, -764, -766, -768, -771, -773, -775, -778, -780, -782, -785, -787, -789, -792, -794, -796, -798, -801, -803, -805, -807, -809, -812, -814, -816, -818, -820, -822, -825, -827, -829, -831, -833, -835, -837, -839, -841, -843, -845, -847, -849, -851, -853, -855, -857, -859, -861, -863, -865, -867, -869, -871, -872, -874, -876, -878, -880, -882, -883, -885, -887, -889, -891, -892, -894, -896, -898, -899, -901, -903, -904, -906, -908, -909, -911, -913, -914, -916, -917, -919, -921, -922, -924, -925, -927, -928, -930, -931, -933, -934, -936, -937, -939, -940, -941, -943, -944, -946, -947, -948, -950, -951, -952, -954, -955, -956, -957, -959, -960, -961, -962, -964, -965, -966, -967, -968, -970, -971, -972, -973, -974, -975, -976, -977, -978, -979, -980, -981, -983, -984, -984, -985, -986, -987, -988, -989, -990, -991, -992, -993, -994, -995, -995, -996, -997, -998, -999, -999, -1000, -1001, -1002, -1002, -1003, -1004, -1005, -1005, -1006, -1007, -1007, -1008, -1009, -1009, -1010, -1010, -1011, -1011, -1012, -1013, -1013, -1014, -1014, -1015, -1015, -1016, -1016, -1016, -1017, -1017, -1018, -1018, -1018, -1019, -1019, -1020, -1020, -1020, -1020, -1021, -1021, -1021, -1022, -1022, -1022, -1022, -1022, -1023, -1023, -1023, -1023, -1023, -1023, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1022, -1022, -1022, -1022, -1021, -1021, -1021, -1021, -1020, -1020, -1020, -1019, -1019, -1019, -1018, -1018, -1018, -1017, -1017, -1016, -1016, -1015, -1015, -1014, -1014, -1013, -1013, -1012, -1012, -1011, -1011, -1010, -1010, -1009, -1008, -1008, -1007, -1006, -1006, -1005, -1004, -1004, -1003, -1002, -1001, -1001, -1000, -999, -998, -998, -997, -996, -995, -994, -993, -993, -992, -991, -990, -989, -988, -987, -986, -985, -984, -983, -982, -981, -980, -979, -978, -977, -976, -975, -974, -973, -971, -970, -969, -968, -967, -966, -964, -963, -962, -961, -960, -958, -957, -956, -954, -953, -952, -950, -949, -948, -946, -945, -944, -942, -941, -939, -938, -937, -935, -934, -932, -931, -929, -928, -926, -925, -923, -922, -920, -918, -917, -915, -914, -912, -910, -909, -907, -905, -904, -902, -900, -899, -897, -895, -893, -892, -890, -888, -886, -885, -883, -881, -879, -877, -875, -874, -872, -870, -868, -866, -864, -862, -860, -858, -856, -854, -852, -850, -848, -846, -844, -842, -840, -838, -836, -834, -832, -830, -828, -826, -824, -822, -819, -817, -815, -813, -811, -809, -806, -804, -802, -800, -797, -795, -793, -791, -788, -786, -784, -782, -779, -777, -775, -772, -770, -768, -765, -763, -760, -758, -756, -753, -751, -748, -746, -743, -741, -738, -736, -733, -731, -728, -726, -723, -721, -718, -716, -713, -711, -708, -706, -703, -700, -698, -695, -692, -690, -687, -685, -682, -679, -676, -674, -671, -668, -666, -663, -660, -658, -655, -652, -649, -646, -644, -641, -638, -635, -633, -630, -627, -624, -621, -618, -616, -613, -610, -607, -604, -601, -598, -595, -592, -589, -587, -584, -581, -578, -575, -572, -569, -566, -563, -560, -557, -554, -551, -548, -545, -542, -539, -536, -533, -530, -527, -523, -520, -517, -514, -511, -508, -505, -502, -499, -496, -492, -489, -486, -483, -480, -477, -474, -470, -467, -464, -461, -458, -454, -451, -448, -445, -442, -438, -435, -432, -429, -425, -422, -419, -416, -412, -409, -406, -402, -399, -396, -393, -389, -386, -383, -379, -376, -373, -369, -366, -363, -359, -356, -353, -349, -346, -343, -339, -336, -332, -329, -326, -322, -319, -315, -312, -309, -305, -302, -298, -295, -292, -288, -285, -281, -278, -274, -271, -267, -264, -261, -257, -254, -250, -247, -243, -240, -236, -233, -229, -226, -222, -219, -215, -212, -208, -205, -201, -198, -194, -191, -187, -184, -180, -177, -173, -170, -166, -163, -159, -156, -152, -149, -145, -141, -138, -134, -131, -127, -124, -120, -117, -113, -110, -106, -102, -99, -95, -92, -88, -85, -81, -77, -74, -70, -67, -63, -60, -56, -52, -49, -45, -42, -38, -35, -31, -27, -24, -20, -17, -13, -10, -6, -2, 1, 5, 8, 12, 15, 19, 23, 26, 30, 33, 37, 40, 44, 48, 51, 55, 58, 62, 65, 69, 73, 76, 80, 83, 87, 90, 94, 98, 101, 105, 108, 112, 115, 119, 122, 126, 129, 133, 137, 140, 144, 147, 151, 154, 158, 161, 165, 168, 172, 175, 179, 182, 186, 190, 193, 197, 200, 204, 207, 211, 214, 218, 221, 225, 228, 232, 235, 238, 242, 245, 249, 252, 256, 259, 263, 266, 270, 273, 277, 280, 283, 287, 290, 294, 297, 301, 304, 307, 311, 314, 318, 321, 324, 328, 331, 335, 338, 341, 345, 348, 351, 355, 358, 361, 365, 368, 371, 375, 378, 381, 385, 388, 391, 395, 398, 401, 405, 408, 411, 414, 418, 421, 424, 427, 431, 434, 437, 440, 444, 447, 450, 453, 456, 460, 463, 466, 469, 472, 476, 479, 482, 485, 488, 491, 494, 498, 501, 504, 507, 510, 513, 516, 519, 522, 525, 528, 532, 535, 538, 541, 544, 547, 550, 553, 556, 559, 562, 565, 568, 571, 574, 577, 580, 583, 585, 588, 591, 594, 597, 600, 603, 606, 609, 612, 614, 617, 620, 623, 626, 629, 631, 634, 637, 640, 643, 645, 648, 651, 654, 656, 659, 662, 665, 667, 670, 673, 675, 678, 681, 684, 686, 689, 691, 694, 697, 699, 702, 705, 707, 710, 712, 715, 717, 720, 722, 725, 728, 730, 733, 735, 738, 740, 742, 745, 747, 750, 752, 755, 757, 759, 762, 764, 767, 769, 771, 774, 776, 778, 781, 783, 785, 788, 790, 792, 794, 797, 799, 801, 803, 806, 808, 810, 812, 814, 816, 819, 821, 823, 825, 827, 829, 831, 833, 835, 838, 840, 842, 844, 846, 848, 850, 852, 854, 856, 858, 860, 862, 863, 865, 867, 869, 871, 873, 875, 877, 878, 880, 882, 884, 886, 888, 889, 891, 893, 895, 896, 898, 900, 901, 903, 905, 906, 908, 910, 911, 913, 915, 916, 918, 919, 921, 923, 924, 926, 927, 929, 930, 932, 933, 935, 936, 938, 939, 940, 942, 943, 945, 946, 947, 949, 950, 951, 953, 954, 955, 957, 958, 959, 960, 962, 963, 964, 965, 966, 968, 969, 970, 971, 972, 973, 974, 975, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 989, 990, 991, 992, 993, 994, 995, 996, 996, 997, 998, 999, 1000, 1000, 1001, 1002, 1003, 1003, 1004, 1005, 1005, 1006, 1007, 1007, 1008, 1009, 1009, 1010, 1010, 1011, 1012, 1012, 1013, 1013, 1014, 1014, 1015, 1015, 1016, 1016, 1017, 1017, 1017, 1018, 1018, 1019, 1019, 1019, 1020, 1020, 1020, 1021, 1021, 1021, 1021, 1022, 1022, 1022, 1022, 1022, 1023, 1023, 1023, 1023, 1023, 1023, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1022, 1022, 1022, 1022, 1021, 1021, 1021, 1021, 1020, 1020, 1020, 1019, 1019, 1019, 1018, 1018, 1017, 1017, 1017, 1016, 1016, 1015, 1015, 1014, 1014, 1013, 1013, 1012, 1012, 1011, 1011, 1010, 1009, 1009, 1008, 1008, 1007, 1006, 1006, 1005, 1004, 1003, 1003, 1002, 1001, 1001, 1000, 999, 998, 997, 997, 996, 995, 994, 993, 992, 991, 991, 990, 989, 988, 987, 986, 985, 984, 983, 982, 981, 980, 979, 978, 977, 976, 974, 973, 972, 971, 970, 969, 968, 966, 965, 964, 963, 962, 960, 959, 958, 957, 955, 954, 953, 951, 950, 949, 947, 946, 945, 943, 942, 941, 939, 938, 936, 935, 933, 932, 930, 929, 927, 926, 924, 923, 921, 920, 918, 916, 915, 913, 912, 910, 908, 907, 905, 903, 902, 900, 898, 897, 895, 893, 891, 890, 888, 886, 884, 882, 881, 879, 877, 875, 873, 871, 869, 867, 866, 864, 862, 860, 858, 856, 854, 852, 850, 848, 846, 844, 842, 840, 838, 836, 834, 832, 830, 827, 825, 823, 821, 819, 817, 815, 812, 810, 808, 806, 804, 801, 799, 797, 795, 792, 790, 788, 786, 783, 781, 779, 776, 774, 772, 769, 767, 765, 762, 760, 757, 755, 753, 750, 748, 745, 743, 740, 738, 735, 733, 730, 728, 725, 723, 720, 718, 715, 713, 710, 707, 705, 702, 700, 697, 694, 692, 689, 687, 684, 681, 679, 676, 673, 670, 668, 665, 662, 660, 657, 654, 651, 649, 646, 643, 640, 637, 635, 632, 629, 626, 623, 620, 618, 615, 612, 609, 606, 603, 600, 598, 595, 592, 589, 586, 583, 580, 577, 574, 571, 568, 565, 562, 559, 556, 553, 550, 547, 544, 541, 538, 535, 532, 529, 526, 523, 520, 517, 513, 510, 507, 504, 501, 498, 495, 492, 489, 485, 482, 479, 476, 473, 470, 466, 463, 460, 457, 454, 450, 447, 444, 441, 438, 434, 431, 428, 425, 421, 418, 415, 411, 408, 405, 402, 398, 395, 392, 388, 385, 382, 379, 375, 372, 369, 365, 362, 358, 355, 352, 348, 345, 342, 338, 335, 332, 328, 325, 321, 318, 315, 311, 308, 304, 301, 298, 294, 291, 287, 284, 280, 277, 274, 270, 267, 263, 260, 256, 253, 249, 246, 242, 239, 235, 232, 228, 225, 221, 218, 214, 211, 207, 204, 200, 197, 193, 190, 186, 183, 179, 176, 172, 169, 165, 162, 158, 155, 151, 148, 144, 141, 137, 133, 130, 126, 123, 119, 116, 112, 109, 105, 102, 98, 94, 91, 87, 84, 80, 77, 73, 69, 66, 62, 59, 55, 52, 48, 44, 41, 37, 34, 30, 27, 23, 19, 16, 12, 9, 5, 2, -2, -6, -9, -13, -16, -20, -23, -27, -31, -34, -38, -41, -45, -48, -52, -56, -59, -63, -66, -70, -73, -77, -81, -84, -88, -91, -95, -98, -102, -106, -109, -113, -116, -120, -123, -127, -130, -134, -137, -141, -145, -148, -152, -155, -159, -162, -166, -169, -173, -176, -180, -183, -187, -190, -194, -197, -201, -204, -208, -211, -215, -218, -222, -225, -229, -232, -236, -239, -243, -246, -250, -253, -257, -260, -264, -267, -271, -274, -277, -281, -284, -288, -291, -295, -298, -301, -305, -308, -312, -315, -318, -322, -325, -329, -332, -335, -339, -342, -345, -349, -352, -356, -359, -362, -366, -369, -372, -376, -379, -382, -386, -389, -392, -395, -399, -402, -405, -409, -412, -415, -418, -422, -425, -428, -431, -435, -438, -441, -444, -448, -451, -454, -457, -460, -464, -467, -470, -473, -476, -479, -483, -486, -489, -492, -495, -498, -501, -505, -508, -511, -514, -517, -520, -523, -526, -529, -532, -535, -538, -541, -544, -548, -551, -554, -557, -560, -563, -566, -568, -571, -574, -577, -580, -583, -586, -589, -592, -595, -598, -601, -604, -607, -609, -612, -615, -618, -621, -624, -627, -629, -632, -635, -638, -641, -643, -646, -649, -652, -654, -657, -660, -663, -665, -668, -671, -673, -676, -679, -682, -684, -687, -689, -692, -695, -697, -700, -703, -705, -708, -710, -713, -715, -718, -721, -723, -726, -728, -731, -733, -736, -738, -741, -743, -746, -748, -750, -753, -755, -758, -760, -762, -765, -767, -770, -772, -774, -777, -779, -781, -784, -786, -788, -790, -793, -795, -797, -799, -802, -804, -806, -808, -811, -813, -815, -817, -819, -821, -823, -826, -828, -830, -832, -834, -836, -838, -840, -842, -844, -846, -848, -850, -852, -854, -856, -858, -860, -862, -864, -866, -868, -870, -872, -873, -875, -877, -879, -881, -883, -884, -886, -888, -890, -892, -893, -895, -897, -898, -900, -902, -904, -905, -907, -909, -910, -912, -913, -915, -917, -918, -920, -921, -923, -924, -926, -928, -929, -931, -932, -934, -935, -936, -938, -939, -941, -942, -944, -945, -946, -948, -949, -950, -952, -953, -954, -956, -957, -958, -959, -961, -962, -963, -964, -965, -967, -968, -969, -970, -971, -972, -974, -975, -976, -977, -978, -979, -980, -981, -982, -983, -984, -985, -986, -987, -988, -989, -990, -991, -992, -992, -993, -994, -995, -996, -997, -997, -998, -999, -1000, -1001, -1001, -1002, -1003, -1004, -1004, -1005, -1006, -1006, -1007, -1008, -1008, -1009, -1009, -1010, -1011, -1011, -1012, -1012, -1013, -1013, -1014, -1014, -1015, -1015, -1016, -1016, -1017, -1017, -1017, -1018, -1018, -1019, -1019, -1019, -1020, -1020, -1020, -1021, -1021, -1021, -1021, -1022, -1022, -1022, -1022, -1023, -1023, -1023, -1023, -1023, -1023, -1023, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1024, -1023, -1023, -1023, -1023, -1023, -1023, -1022, -1022, -1022, -1022, -1022, -1021, -1021, -1021, -1020, -1020, -1020, -1020, -1019, -1019, -1019, -1018, -1018, -1017, -1017, -1016, -1016, -1016, -1015, -1015, -1014, -1014, -1013, -1013, -1012, -1012, -1011, -1010, -1010, -1009, -1009, -1008, -1007, -1007, -1006, -1005, -1005, -1004, -1003, -1003, -1002, -1001, -1000, -1000, -999, -998, -997, -996, -996, -995, -994, -993, -992, -991, -990, -989, -988, -988, -987, -986, -985, -984, -983, -982, -981, -980, -979, -977, -976, -975, -974, -973, -972, -971, -970, -969, -967, -966, -965, -964, -963, -961, -960, -959, -958, -956, -955, -954, -952, -951, -950, -948, -947, -946, -944, -943, -942, -940, -939, -937, -936, -934, -933, -931, -930, -928, -927, -925, -924, -922, -921, -919, -918, -916, -914, -913, -911, -910, -908, -906, -905, -903, -901, -900, -898, -896, -894, -893, -891, -889, -887, -886, -884, -882, -880, -878, -876, -875, -873, -871, -869, -867, -865, -863, -861, -859, -857, -855, -853, -851, -849, -847, -845, -843, -841, -839, -837, -835, -833, -831, -829, -827, -825, -823, -821, -818, -816, -814, -812, -810, -807, -805, -803, -801, -799, -796, -794, -792, -790, -787, -785, -783, -780, -778, -776, -773, -771, -769, -766, -764, -762, -759, -757, -754, -752, -750, -747, -745, -742, -740, -737, -735, -732, -730, -727, -725, -722, -720, -717, -715, -712, -709, -707, -704, -702, -699, -696, -694, -691, -688, -686, -683, -681, -678, -675, -672, -670, -667, -664, -662, -659, -656, -653, -651, -648, -645, -642, -640, -637, -634, -631, -628, -625, -623, -620, -617, -614, -611, -608, -605, -603, -600, -597, -594, -591, -588, -585, -582, -579, -576, -573, -570, -567, -564, -561, -558, -555, -552, -549, -546, -543, -540, -537, -534, -531, -528, -525, -522, -519, -516, -513, -510, -507, -503, -500, -497, -494, -491, -488, -485, -481, -478, -475, -472, -469, -466, -462, -459, -456, -453, -450, -446, -443, -440, -437, -433, -430, -427, -424, -420, -417, -414, -411, -407, -404, -401, -398, -394, -391, -388, -384, -381, -378, -374, -371, -368, -364, -361, -358, -354, -351, -348, -344, -341, -337, -334, -331, -327, -324, -321, -317, -314, -310, -307, -304, -300, -297, -293, -290, -286, -283, -280, -276, -273, -269, -266, -262, -259, -255, -252, -248, -245, -241, -238, -235, -231, -228, -224, -221, -217, -214, -210, -207, -203, -200, -196, -193, -189, -186, -182, -179, -175, -171, -168, -164, -161, -157, -154, -150, -147, -143, -140, -136, -133, -129, -125, -122, -118, -115, -111, -108, -104, -101, -97, -93, -90, -86, -83, -79, -76, -72, -69, -65, -61, -58, -54, -51, -47, -44, -40, -36, -33, -29, -26, -22, -19, -15, -11, -8, -4, -1, 3, 6, 10, 14, 17, 21, 24, 28, 32, 35, 39, 42, 46, 49, 53, 57, 60, 64, 67, 71, 74, 78, 81, 85, 89, 92, 96, 99, 103, 106, 110, 114, 117, 121, 124, 128, 131, 135, 138, 142, 145, 149, 153, 156, 160, 163, 167, 170, 174, 177, 181, 184, 188, 191, 195, 198, 202, 205, 209, 212, 216, 219, 223, 226, 230, 233, 237, 240, 244, 247, 251, 254, 258, 261, 264, 268, 271, 275, 278, 282, 285, 289, 292, 295, 299, 302, 306, 309, 312, 316, 319, 323, 326, 329, 333, 336, 340, 343, 346, 350, 353, 356, 360, 363, 366, 370, 373, 376, 380, 383, 386, 390, 393, 396, 400, 403, 406, 409, 413, 416, 419, 423, 426, 429, 432, 436, 439, 442, 445, 448, 452, 455, 458, 461, 464, 468, 471, 474, 477, 480, 483, 487, 490, 493, 496, 499, 502, 505, 508, 512, 515, 518, 521, 524, 527, 530, 533, 536, 539, 542, 545, 548, 551, 554, 557, 560, 563, 566, 569, 572, 575, 578, 581, 584, 587, 590, 593, 596, 599, 601, 604, 607, 610, 613, 616, 619, 622, 624, 627, 630, 633, 636, 638, 641, 644, 647, 650, 652, 655, 658, 661, 663, 666, 669, 671, 674, 677, 680, 682, 685, 688, 690, 693, 695, 698, 701, 703, 706, 708, 711, 714, 716, 719, 721, 724, 726, 729, 731, 734, 736, 739, 741, 744, 746, 749, 751, 753, 756, 758, 761, 763, 765, 768, 770, 773, 775, 777, 780, 782, 784, 786, 789, 791, 793, 796, 798, 800, 802, 804, 807, 809, 811, 813, 815, 818, 820, 822, 824, 826, 828, 830, 832, 834, 837, 839, 841, 843, 845, 847, 849, 851, 853, 855, 857, 859, 861, 862, 864, 866, 868, 870, 872, 874, 876, 878, 879, 881, 883, 885, 887, 888, 890, 892, 894, 895, 897, 899, 901, 902, 904, 906, 907, 909, 911, 912, 914, 915, 917, 919, 920, 922, 923, 925, 926, 928, 929, 931, 932, 934, 935, 937, 938, 940, 941, 942, 944, 945, 947, 948, 949, 951, 952, 953, 955, 956, 957, 958, 960, 961, 962, 963, 965, 966, 967, 968, 969, 970, 972, 973, 974, 975, 976, 977, 978, 979, 980, 981, 982, 983, 984, 985, 986, 987, 988, 989, 990, 991, 992, 993, 994, 994, 995, 996, 997, 998, 998, 999, 1000, 1001, 1002, 1002, 1003, 1004, 1004, 1005, 1006, 1006, 1007, 1008, 1008, 1009, 1010, 1010, 1011, 1011, 1012, 1012, 1013, 1013, 1014, 1014, 1015, 1015, 1016, 1016, 1017, 1017, 1018, 1018, 1018, 1019, 1019, 1019, 1020, 1020, 1020, 1021, 1021, 1021, 1021, 1022, 1022, 1022, 1022, 1023, 1023, 1023, 1023, 1023, 1023, 1023, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1024, 1023, 1023, 1023, 1023, 1023, 1023, 1022, 1022, 1022, 1022, 1022, 1021, 1021, 1021, 1020, 1020, 1020, 1019, 1019, 1019, 1018, 1018, 1018, 1017, 1017, 1016, 1016, 1015, 1015, 1015, 1014, 1014, 1013, 1013, 1012, 1011, 1011, 1010, 1010, 1009, 1008, 1008, 1007, 1007, 1006, 1005, 1005, 1004, 1003, 1002, 1002, 1001, 1000, 999, 999, 998, 997, 996, 995, 994, 994, 993, 992, 991, 990, 989, 988, 987, 986, 985, 984, 983, 982, 981, 980, 979, 978, 977, 976, 975, 974, 973, 972, 971, 969, 968, 967, 966, 965, 964, 962, 961, 960, 959, 957, 956, 955, 953, 952, 951, 949, 948, 947, 945, 944, 943, 941, 940, 938, 937, 936, 934, 933, 931, 930, 928, 927, 925, 924, 922, 920, 919, 917, 916, 914, 912, 911, 909, 908, 906, 904, 902, 901, 899, 897, 896, 894, 892, 890, 889, 887, 885, 883, 881, 880, 878, 876, 874, 872, 870, 868, 867, 865, 863, 861, 859, 857, 855, 853, 851, 849, 847, 845, 843, 841, 839, 837, 835, 833, 831, 828, 826, 824, 822, 820, 818, 816, 814, 811, 809, 807, 805, 803, 800, 798, 796, 794, 791, 789, 787, 784, 782, 780, 778, 775, 773, 770, 768, 766, 763, 761, 759, 756, 754, 751, 749, 746, 744, 742, 739, 737, 734, 732, 729, 727, 724,
                                                  };
*/
//---- Pins -----
const int IN_4 = 6;           //PA20
const int IN_3 = 5;           //PA15
const int VREF_2 = 4;         //PA08
const int VREF_1 = 9;         //PA07
const int IN_2 = 7;           //PA21
const int IN_1 = 8;           //PA06
const int ledPin = 13;        //PA17
const int chipSelectPin = A2; //PB08
const int dir_pin = 0;        //PORT_PA11
const int step_pin = 1;       //Port_PA10
const int ena_pin = 2;        //PORT_PA14


const float M_Pi = 3.1415926535897932384626433832795;

//--- PID autotuning variables ---
bool tune_running = false; //set flag for running indication

